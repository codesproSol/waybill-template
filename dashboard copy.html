<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v6.0.0-beta3/css/all.css">
    <script src="https://cdn.jsdelivr.net/npm/@panzoom/panzoom@4.0.0/dist/panzoom.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/share-this/1.3.1/share-this.min.css"
        integrity="sha512-D2vagE/4+QTyP2FukMZNoZxcO1Uqcd0SsnqczdOm+zu35XDsFDIroYXxDD0WrYbyPFKD1vUmhxaCC3kR8WBNZA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

    <!-- jQuery -->



    <link rel="stylesheet" href="waybill.css">

    <title>Document</title>

</head>

<body>


    <div class="epod_cont cpsl">
        <aside>
            <nav class="epod_nav">


                <div class="user_wrap" onclick="ToggleNavMenu(this)">
                    <div class="user_img">
                        <img src="/" alt="">
                        <div class="user_initial"></div>
                    </div>
                    <div class="wrap_flex">
                        <h6>Welcome</h6>
                        <h2 id="username" class="text-wrap-user">Administrator@gmail</h4>
                    </div>

                </div>
                <div class="close_sidebar" onclick="handleCloseSidebar()">X</div>
                <ul>



                    <li class="nav-item settings"><a href="#" onclick="switchToSettings()"><i
                                class="fas fa-cog"></i>Settings</a></li>
                    <li class="nav-item signout"><a href="#"><i class="fas fa-sign-out-alt"></i>Sign Out</a></li>
                </ul>
            </nav>
        </aside>
        <main>
            <div class="epod_contents">
                <div class="epod_tracking">
                    <div class="header">
                        <button class="nav-toggle" onclick="toggleSidebar()">☰</button>
                        <h3>Tracking</h3>
                        <div class="search_cont" onclick="handleDropSearch()">
                            <i class="fa fa-search"></i>
                        </div>
                    </div>
                    <div class="search_box">

                        <div class="search">
                            <input type="search" placeholder="Search..." name="" id="searchInput">
                            <div class="search_icon" onclick="searchBoxes()">
                                <i class="fa fa-search"></i>
                            </div>
                        </div>

                        <!-- Checkbox Filters -->
                        <!-- <div class="filter_options">
                            <label>
                                <input type="checkbox" class="filter_checkbox" value="bl">
                                BL
                            </label>
                            <label>
                                <input type="checkbox" class="filter_checkbox" value="consignment">
                                Consignment
                            </label>
                            <label>
                                <input type="checkbox" class="filter_checkbox" value="waybill">
                                Waybill
                            </label>
                            <label>
                                <input type="checkbox" class="filter_checkbox" value="status">
                                Status
                            </label>
                        </div> -->

                    </div>
                    <div class="filter_lists">
                        <div class="header2 small"><i class="fa-light fa-filter"></i>Filters </div>
                        <div class="filter_list">
                            <div class="list filter" data-filter="en route">
                                <div class="toggle_switch">
                                    <span class="filter_text">en route</span>
                                    <div class="toggle_ball"></div>
                                </div>
                            </div>
                            <div class="list filter" data-filter="Pending">
                                <div class="toggle_switch">
                                    <span class="filter_text">Awaiting takeoff</span>
                                    <div class="toggle_ball"></div>
                                </div>
                            </div>

                            <div class="list filter" data-filter="Completed">
                                <div class="toggle_switch">
                                    <span class="filter_text">In transit</span>
                                    <div class="toggle_ball"></div>
                                </div>
                            </div>
                            <div class="list filter" data-filter="Cancelled">
                                <div class="toggle_switch">
                                    <span class="filter_text">Arrived</span>
                                    <div class="toggle_ball"></div>
                                </div>
                            </div>
                            <div class="list filter" data-filter="In Progress">
                                <div class="toggle_switch">
                                    <span class="filter_text">Completed</span>
                                    <div class="toggle_ball"></div>
                                </div>
                            </div>
                        </div>
                        <!-- <div class="header small">show</div> -->


                    </div>
                    <div class="epod_content">
                        <button class="collapse_button ">Collapse map</button>
                        <div class="map_t">

                            <div class="embed-map-responsive">
                                <div class="embed-map-container"><iframe class="embed-map-frame" frameborder="0"
                                        scrolling="no" marginheight="0" marginwidth="0"
                                        src="https://maps.google.com/maps?width=600&height=400&hl=en&q=University%20of%20Oxford&t=&z=14&ie=UTF8&iwloc=B&output=embed"></iframe><a
                                        href="https://cartoongames.io"
                                        style="font-size:2px!important;color:gray!important;position:absolute;bottom:0;left:0;z-index:1;max-height:10px;overflow:hidden">Cartoon
                                        Games</a><a href="https://heygames.org"
                                        style="font-size:2px!important;color:gray!important;position:absolute;bottom:0;left:0;z-index:1;max-height:10px;overflow:hidden">HeyGames</a><a
                                        href="https://map-embed.org"
                                        style="font-size:2px!important;color:gray!important;position:absolute;bottom:0;left:0;z-index:1;max-height:10px;overflow:hidden">google
                                        maps generator</a></div>
                                <style>
                                    .embed-map-responsive {
                                        position: relative;
                                        text-align: right;
                                        width: 100%;
                                        height: 0;
                                        padding-bottom: 66.66666666666666%;
                                    }

                                    .embed-map-container {
                                        overflow: hidden;
                                        background: none !important;
                                        width: 100%;
                                        height: 200px;
                                        position: absolute;
                                        top: 0;
                                        left: 0;
                                    }

                                    .embed-map-frame {
                                        width: 100% !important;
                                        height: 100% !important;
                                        position: absolute;
                                        top: 0;
                                        left: 0;
                                    }
                                </style>
                            </div>
                        </div>



                        <div class="stwitch-buttns">
                            <button class="btn-primary" id="convertToBoxes" disabled>
                                <i class="fa fa-box"></i>
                                Boxes
                            </button>
                            <button class="btn-primary" id="convertToTable">
                                <i class="fa fa-table"></i>
                                Table
                            </button>

                        </div>

                        <div class="epod_boxes" id="dataContainer">
                            <div class="epod_dash_box in-transit">
                                <div class="header">
                                    <div class="track_id">XY-1234-LAG</div>
                                    <div class="status enroute trackeron">
                                        <div></div>
                                        <p>en route</p>
                                    </div>
                                </div>
                                <div class="truck_destination">
                                    <div class="time_details">
                                        <span class="time">06:15:00</span>
                                        <span class="day">3 days left</span>
                                    </div>
                                    <div class="destination_info">
                                        <div class="route active">
                                            <p>Ojodu Berger, Lagos Lorem ipsum dolor sit amet
                                                consectetur adipisicing elit. Atque blanditiis, molestiae suscipit nobis
                                                asperiores tempore quia eveniet optio culpa nihil expedita hic officiis
                                                ad
                                                ea possimus iste, dicta non aperiam.</p>
                                        </div>
                                        <div class="route active">
                                            <p>Ikeja, Lagos</p>
                                        </div>
                                        <div class="route">
                                            <p>Lekki Phase 1, Lagos</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="truck_img">
                                    <img src="img.png" alt="truckdetails">
                                </div>
                                <div class="bl_no" style="display: none;">BL-001234</div>
                            </div>
                            <div class="epod_dash_box">
                                <div class="header">
                                    <div class="track_id">XY-3454-LAG</div>
                                    <div class="status enroute trackeron">
                                        <div></div>
                                        <p>en route</p>
                                    </div>
                                </div>
                                <div class="truck_destination">
                                    <div class="time_details">
                                        <span class="time">06:15:00</span>
                                        <span class="day">3 days left</span>
                                    </div>
                                    <div class="destination_info">
                                        <div class="route active">
                                            <p>Egbeda</p>
                                        </div>
                                        <div class="route active">
                                            <p>Ikeja, Lagos</p>
                                        </div>
                                        <div class="route">
                                            <p>Lekki Phase 1, Lagos</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="truck_img">
                                    <img src="img.png" alt="truckdetails">
                                </div>
                                <div class="bl_no" style="display: none;">BL-001234</div>
                            </div>
                            <div class="epod_dash_box">
                                <div class="header">
                                    <div class="track_id">XY-5678-ABJ</div>
                                    <div class="status arrived">
                                        <div></div>
                                        <p>Arrived</p>
                                    </div>
                                </div>
                                <div class="truck_destination">
                                    <div class="time_details">
                                        <span class="time">08:45:00</span>
                                        <span class="day">0 days left</span>
                                    </div>
                                    <div class="destination_info">
                                        <div class="route active">
                                            <p>Garki, Abuja</p>
                                        </div>
                                        <div class="route active">
                                            <p>Maitama, Abuja</p>
                                        </div>
                                        <div class="route active">
                                            <p>Wuse 2, Abuja</p>
                                        </div>
                                        <div class="route active">
                                            <p>Asokoro, Abuja</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="truck_img">
                                    <img src="img.png" alt="truckdetails">
                                </div>
                                <div class="bl_no" style="display: none;">BL-005678</div>
                            </div>
                            <div class="epod_dash_box">
                                <div class="header">
                                    <div class="track_id">XY-9101-KAN</div>
                                    <div class="status awaiting-takeoff">
                                        <div></div>
                                        <p>Awaiting takeoff</p>
                                    </div>
                                </div>
                                <div class="truck_destination">
                                    <div class="time_details">
                                        <span class="time">09:10:00</span>
                                        <span class="day">Pending</span>
                                    </div>
                                    <div class="destination_info">
                                        <div class="route">Sabon Gari, Kano</div>
                                        <div class="route">Tarauni, Kano</div>
                                        <div class="route">Bompai, Kano</div>
                                    </div>
                                </div>
                                <div class="truck_img">
                                    <img src="img.png" alt="truckdetails">
                                </div>
                                <div class="bl_no" style="display: none;">BL-009101</div>
                            </div>
                            <div class="epod_dash_box">
                                <div class="header">
                                    <div class="track_id">XY-2345-PHC</div>
                                    <div class="status completed">
                                        <div></div>
                                        <p>Completed</p>
                                    </div>
                                </div>
                                <div class="truck_destination">
                                    <div class="time_details">
                                        <span class="time">10:30:00</span>
                                        <span class="day">0 days left</span>
                                    </div>
                                    <div class="destination_info">
                                        <div class="route active">
                                            <p>Mile 3, Port Harcourt</p>
                                        </div>
                                        <div class="route active">
                                            <p>GRA Phase 2, Port Harcourt</p>
                                        </div>
                                        <div class="route active">
                                            <p>Rumuokoro, Port Harcourt</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="truck_img">
                                    <img src="img.png" alt="truckdetails">
                                </div>
                                <div class="bl_no" style="display: none;">BL-002345</div>
                            </div>
                            <div class="epod_dash_box">
                                <div class="header">
                                    <div class="track_id">XY-6789-KAD</div>
                                    <div class="status trackeron intransit">
                                        <div></div>
                                        <p>In transit</p>
                                    </div>
                                </div>
                                <div class="truck_destination">
                                    <div class="time_details">
                                        <span class="time">11:45:00</span>
                                        <span class="day">2 days left</span>
                                    </div>
                                    <div class="destination_info">
                                        <div class="route active">Unguwan Rimi, Kaduna</div>
                                        <div class="route active">Barnawa, Kaduna</div>
                                        <div class="route">Sabo, Kaduna</div>
                                        <div class="route">Tudun Wada, Kaduna</div>
                                    </div>
                                </div>
                                <div class="truck_img">
                                    <img src="img.png" alt="truckdetails">
                                </div>
                                <div class="bl_no" style="display: none;">BL-006789</div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="epod_details">
                    <div class="loading-animation">
                        <div class="pulse-loader">
                            <div class="pulse-circle"></div>
                            <div class="pulse-circle"></div>
                            <svg viewBox="0 0 100 100" class="letter-svg">
                                <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle">E</text>
                            </svg>
                        </div>
                    </div>
                    <div class="header">
                        <div class="cancel_button" onclick="handleSideToggle()"><i class="fa fa-arrow-right"></i></div>
                        <div class="track_id">XY-1234-LAG</div>
                        <div class="status intransit trackeron">
                            <div></div>
                            <p>In transit</p>
                        </div>
                        <div class="call_action">
                            <button class="call_btn"><i class="fa-solid fa-phone"></i><span
                                    class="sm-hidden">Contact</span>
                            </button>
                            <div class="call_dropdown">
                                <a href="tel:+1234567890"><i class="fa-solid fa-user"></i> Call
                                    Driver
                                </a>
                                <a href="tel:+1987654321"><i class="fa-solid fa-headset"></i>Call
                                    Support</a>
                                <a href="tel:+1122334455"><i class="fa-solid fa-building"></i> Call Company</a>
                            </div>
                        </div>
                        <div class="chat_action">
                            <button class="chat_btn"><i class="fa-solid fa-comments"></i><span class="sm-hidden">chat
                                </span></button>
                            <div class="chat_dropdown">
                                <a href="sms:+1234567890"><i class="fa-solid fa-user"></i> Chat with Driver</a>
                                <a href="sms:+1987654321"><i class="fa-solid fa-headset"></i> Chat with Support</a>
                                <a href="sms:+1122334455"><i class="fa-solid fa-building"></i> Chat with Company</a>
                            </div>
                        </div>
                    </div>
                    <div class="epod_details-nav">
                        <div class="epod_navlinks">
                            <button type="button" class="current" id="shipment" title="navigate to tab"
                                class="epod_navlink">shipment
                                Info</button>
                            <button type="button" id="vechicle" title="navigate to tab" class="epod_navlink">Vechicle
                                Info</button>
                            <button type="button" id="driver" title="navigate to tab" class="epod_navlink">Driver
                                Info</button>
                            <button type="button" id="document" title="navigate to tab"
                                class="epod_navlink">Documents</button>
                            <button type="button" id="company" title="navigate to tab"
                                class="epod_navlink">Company</button>
                            <button type="button" id="waybill_p" title="navigate to tab"
                                class="epod_navlink">Waybill</button>
                            <!-- <button type="button" id="waybill_p2" title="navigate to tab"
                                class="epod_navlink">S_P_Waybill</button> -->
                        </div>
                    </div>
                    <div class="epod-tab_contents">
                        <div id="shipment" class="tab">
                            <div class="title">Shipment Info</div>
                            <div class="status_controls">
                                <button id="startTrip" class="status_btn start">Start Trip</button>
                                <button id="markArrival" class="status_btn arrival">Mark as Arrived</button>
                                <button id="confirmArrival" class="status_btn arrival">Confirm Arrival</button>
                                <button id="offloadCompleted" class="status_btn completed">Offload Completed</button>
                            </div>

                            <!-- Status Display -->
                            <div class="status_info">
                                <p id="tripStatus">Trip: <span class="status_value">Not yet started</span></p>
                                <p id="arrivalStatus">Arrival: <span class="status_value">Not yet marked</span></p>
                                <p id="confirmarrivalStatus">Arrival Confirmation: <span class="status_value">Not yet
                                        confirmed</span></p>
                                <p id="offcompletionStatus">Offload Completion: <span class="status_value">Not yet
                                        marked</span></p>
                            </div>


                            <!-- <div class="img_box"></div> -->
                            <div class="epod_route">
                                <div class="header">
                                    <div class="title">Route</div>
                                    <div class="right">
                                        <div class="timer">09:40:55</div>
                                        <div class="mins_left">23mins. Left</div>
                                    </div>

                                </div>
                                <div class="map">
                                    <div class="map_details">
                                        <div class="map_header">
                                            <button class="cancel_button">
                                                <i class="fa fa-plus"></i>
                                            </button>

                                            <div class="filter_list">
                                                <div class="list">
                                                    <input type="checkbox" id="in progress">
                                                    <p>All in progress transaction</p>
                                                </div>

                                            </div>
                                        </div>
                                        <div class="map_view"></div>

                                    </div>


                                </div>
                            </div>
                        </div>
                        <div id="vechicle" class="tab">
                            <div class="vehicle">
                                <div class="title"><i class="fa-solid fa-truck"></i> Vehicle Info</div>

                                <div class="infos">
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-hashtag"></i> Truck Number:</p>
                                        <p>ABJRK-12345</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-weight-hanging"></i> Capacity:</p>
                                        <p>10,000 kg</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-car-side"></i> Plate Number:</p>
                                        <p>XY-9876-LAG</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-user"></i> Assigned Driver:</p>
                                        <p>Adewale Ayuba</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-calendar"></i> Last Maintenance:</p>
                                        <p>12th Feb 2025</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-gas-pump"></i> Fuel Type:</p>
                                        <p>Diesel</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-circle-check"></i> Status:</p>
                                        <p class="status available"><i class="fa-solid fa-check-circle"></i> Available
                                        </p>
                                    </div>
                                </div>

                                <div class="truck_images">
                                    <h3> Truck Photos</h3>
                                    <!-- Truck Image Gallery -->
                                    <div class="image_gallery">
                                        <div class="truck_image">
                                            <img src="img.png" alt="Truck Photo"
                                                onclick="openPreview(this, 'Truck Photo')">
                                        </div>
                                        <div class="truck_image">
                                            <img src="plate.jpg" alt="License Plate"
                                                onclick="openPreview(this, 'License Plate')">
                                        </div>

                                    </div>
                                </div>

                                <div class="vehicle_feedback">
                                    <h3>Rate and Review Vehicle</h3>
                                    <p>How satisfied are you with this vehicle?</p>
                                    <div class="rating vehicle_v">
                                        <span class="star" onclick="rateVehicle(1)"><i
                                                class="fa-light fa-star"></i></span>
                                        <span class="star" onclick="rateVehicle(2)"><i
                                                class="fa-light fa-star"></i></span>
                                        <span class="star" onclick="rateVehicle(3)"><i
                                                class="fa-light fa-star"></i></span>
                                        <span class="star" onclick="rateVehicle(4)"><i
                                                class="fa-light fa-star"></i></span>
                                        <span class="star" onclick="rateVehicle(5)"><i
                                                class="fa-light fa-star"></i></span>
                                    </div>
                                    <textarea id="vehicleComment" class="oppi"
                                        placeholder="Leave a comment..."></textarea>
                                    <button class="call_btn boopt"
                                        onclick="submitVehicleFeedback('vehicle')">Submit</button>

                                </div>

                            </div>

                        </div>
                        <div id="driver" class="tab">
                            <div class="driver">
                                <div class="title"><i class="fa-solid fa-user-tie"></i> Driver Info</div>

                                <div class="infos">
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-id-badge"></i> Driver Name:</p>
                                        <p>Adewale Ayuba</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-id-card"></i> Driver License Number:</p>
                                        <p>DL-987654</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-phone"></i> Contact:</p>
                                        <p>+234 812 345 6789</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-phone-volume"></i> Emergency Contact:</p>
                                        <p>+234 801 234 5678 (Boluwatife - Wife)</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-location-dot"></i> Address:</p>
                                        <p>23, Olowu Street, Lagos, Nigeria</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-truck"></i> Assigned Vehicle:</p>
                                        <p>ABJRK-12345</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-user-check"></i> Status:</p>
                                        <p class="status active"><i class="fa-solid fa-circle-check"></i> Active</p>
                                    </div>
                                </div>

                                <div class="driver_images">
                                    <h3 class="light">Driver Photos</h3>
                                    <div class="image_gallery">

                                        <div class="driver_image">
                                            <img src="./truck_image.jpg" alt="Adewale Ayuba" id="AdewaleAyuba"
                                                onclick="openPreview(this,'AdewaleAyuba')">
                                        </div>

                                        <div class="driver_image">
                                            <img src="image.png" alt="Driver ID" id="driverID"
                                                onclick="openPreview(this,'driverID')">
                                        </div>
                                    </div>
                                </div>

                                <div class="driver_feedback">
                                    <h3> Rate and review driver</h3>
                                    <div class="rating driver_r">

                                        <span class="star" onclick="rateDriver(1)"><i
                                                class="fa-light fa-star"></i></span>
                                        <span class="star" onclick="rateDriver(2)"><i
                                                class="fa-light fa-star"></i></span>
                                        <span class="star" onclick="rateDriver(3)"><i
                                                class="fa-light fa-star"></i></span>
                                        <span class="star" onclick="rateDriver(4)"><i
                                                class="fa-light fa-star"></i></span>
                                        <span class="star" onclick="rateDriver(5)"><i
                                                class="fa-light fa-star"></i></span>
                                    </div>
                                    <textarea id="comment" class="oppi" placeholder="Leave a comment..."></textarea>
                                    <button class="call_btn boopt" onclick="submitDriverFeedback()">Submit</button>

                                </div>


                            </div>
                        </div>
                        <div id="document" class="tab">
                            <div class="header">
                                <div class="title">Document</div>
                                <div class="actions">
                                    <button onclick="downloadSelectedDocs()"><i class="fa fa-download"></i></button>
                                    <button onclick="downloadDocAsZIP()"> <i class="fa fa-file-zipper"></i> </button>
                                    <!-- <button><i class="fa fa-envelope"></i> </button> -->
                                    <button onclick="shareWaydocFile()"><i class="fa fa-share"></i> </button>
                                    <button onclick="deleteSelectedDocs()">
                                        <i class="fa fa-trash"></i>
                                    </button>
                                    <!-- <button onclick="window.print()"><i class="fa fa-print"></i> </button> -->
                                </div>

                            </div>
                            <div class="actions_2">
                                <button onclick="document.getElementById('fileInput').click()" class="green"
                                    title="add new document">
                                    <i class="fa fa-plus "></i>
                                </button>
                                <!-- ---snap document button---- -->
                                <button onclick="snapDocument()" title="snap document">
                                    <i class="fa fa-camera"></i>
                                </button>

                                <!-- Hidden File Input -->
                                <input type="file" id="fileInput" style="display: none;"
                                    onchange="handleFileUpload(event)">
                            </div>
                            <div class="document_list">
                                <ul id="doc_list">
                                    <li>
                                        <label>
                                            <input type="checkbox" class="doc_checkbox" data-file="invoice.pdf">
                                            <span class="doc_number">1.</span>
                                            <span class="doc_name">Invoice</span>
                                        </label>
                                        <img class="thumbnail" src="pdf_icon.png" alt="PDF" data-file="invoice.pdf">
                                        <div class="button_bt">
                                            <button onclick="previewDocument('invoice.pdf')"><i
                                                    class="fa fa-eye"></i></button>
                                        </div>

                                    </li>
                                    <li>
                                        <label>
                                            <input type="checkbox" class="doc_checkbox" data-file="bill_of_lading.docx">
                                            <span class="doc_number">2.</span>
                                            <span class="doc_name">Bill of Lading</span>
                                        </label>
                                        <img class="thumbnail" src="doc.png" alt="DOCX" data-file="bill_of_lading.docx">
                                        <div class="button_bt">
                                            <button onclick="previewDocument('bill_of_lading.docx')"><i
                                                    class="fa fa-eye"></i></button>
                                        </div>
                                    </li>
                                    <li>
                                        <label>
                                            <input type="checkbox" class="doc_checkbox" data-file="truck_image.jpg">
                                            <span class="doc_number">3.</span>
                                            <span class="doc_name">Truck Image</span>
                                        </label>
                                        <img class="thumbnail" src="truck_image.jpg" alt="Image"
                                            data-file="truck_image.jpg">
                                        <div class="button_bt">
                                            <button onclick="previewDocument('truck_image.jpg')"><i
                                                    class="fa fa-eye"></i></button>
                                        </div>
                                    </li>
                                </ul>
                            </div>

                            <!-- Document Preview -->
                            <div class="doc_img">
                                <iframe id="pdf_preview" style="display:none; width:100%; height:400px;"></iframe>
                                <img id="image_preview" style="display:none; width:100%; max-width:500px;">
                                <p id="unsupported_preview" style="display:none; color:red;">Preview not supported for
                                    this
                                    file type.</p>
                            </div>
                        </div>
                        <div id="company" class="tab">
                            <div class="company">
                                <div class="title"><i class="fa-solid fa-building"></i> Company Info</div>

                                <div class="infos">
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-id-badge"></i> Company Name:</p>
                                        <p>DAO Logistics Ltd.</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-location-dot"></i> Address:</p>
                                        <p>12 Marina Road, Lagos, Nigeria</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-phone"></i> Contact Number:</p>
                                        <p>+234 812 345 6789</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-envelope"></i> Email:</p>
                                        <p>info@daologistics.com</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-globe"></i> Website:</p>
                                        <p><a href="https://www.daologistics.com"
                                                target="_blank">www.daologistics.com</a>
                                        </p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-calendar"></i> Established:</p>
                                        <p>2015</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-warehouse"></i> Services:</p>
                                        <p>Freight, Warehousing, Transportation, Customs Clearance</p>
                                    </div>
                                    <div class="info">
                                        <p class="bold"><i class="fa-solid fa-users"></i> Employees:</p>
                                        <p>250+</p>
                                    </div>
                                </div>


                            </div>
                        </div>
                        <div id="waybill_p" class="tab">

                            <div class="scale-container">
                                <button type="button" onclick="handleSign()" class="bt1op" title="Sign"> <i
                                        class="fa-sharp fa-solid fa-pen-nib"></i>
                                </button>
                                <button type="button" onclick="handleStamp()" class="bt2op" title="Stamp"> <i
                                        class="fa-sharp fa-solid fa-stamp"></i>
                                </button>
                                <button onclick="panzoom.zoomIn()" title="Zoom In"> <i class="fa fa-plus"></i> </button>
                                <button onclick="panzoom.zoomOut()" title="Zoom Out">
                                    <div class="fa fa-minus" title="Reset Zoom"></div>
                                </button>
                                <button onclick="panzoom.reset()"><i class="fa fa-refresh"></i></button>
                            </div>
                            <div id="zoom-container" data-action="zoom">
                                <div class="waybill_container" id="waybill">



                                    <div class="header">
                                        <div class="logo_cont"></div>
                                        <div class="logo_cont js-left">
                                            <div class="logo">
                                                <img src="./ing.png" alt="">
                                            </div>
                                        </div>

                                    </div>
                                    <h2 class="title2">WAYBILL <span class="waybill_num">FMCG/2024/0001</span></h2>
                                    <h3>DISPATCH SECTION</h3>
                                    <div class="patner_cont">
                                        <h3>Client Information</h3>
                                        <p><span class="bold">Client:</span> <span class="p_info">BURN STOVES NIGERIA
                                                LIMITED</span></p>
                                        <p><span class="bold">Address:</span>
                                            <span class="add_info">Nigeria Limited, Bala Dawakin Industrial Layout,
                                                Charo
                                                Junction, Off Dawakin Kudu Road, Dawakin Local Government, Kano State,
                                                Nigeria.</span> Burn
                                        </p>
                                        <p><span class="bold">Contact Person:</span>
                                            <span class="cont_info">Jerry</span>
                                        </p>
                                        <p><span class="bold">Phone:</span>
                                            <span class="tel_info">08138543842</span>
                                        </p>
                                    </div>


                                    <h3>Transporter Information</h3>
                                    <table>
                                        <tr>
                                            <th>Transporter's Name</th>
                                            <td>Libra Circle</td>
                                            <!-- <th>Freight Forwarder</th>
                                            <td>Not specified</td> -->
                                        </tr>
                                    </table>

                                    <h3>Waybill Details</h3>
                                    <table>
                                        <tr>
                                            <th>BL Number</th>
                                            <td>PNG000602-240418068/AGLN0806[SHPL40620400]</td>
                                            <th>Container No.</th>
                                            <td>PCIU1924760</td>
                                        </tr>
                                        <tr>
                                            <th>Container Seal No.</th>
                                            <td>Not specified</td>
                                            <th>Sealed (Yes/No)</th>
                                            <td>Not specified</td>
                                        </tr>
                                        <tr>
                                            <th>Tracker Found (Yes/No)</th>
                                            <td>Not specified</td>
                                            <th>Loaded Date</th>
                                            <td>Not specified</td>
                                        </tr>
                                    </table>

                                    <h3>Shipment Information</h3>
                                    <table>
                                        <tr>
                                            <th>CLIENT REF</th>
                                            <td>xxx112</td>
                                            <th>CONSIGNEE</th>
                                            <td>BURN STOVES NIGERIA LIMITED</td>
                                        </tr>
                                        <tr>
                                            <th>FROM</th>
                                            <td>Burn Nigeria Limited, Bala Dawakin Industrial Layout, Charo junction,
                                                Kano
                                                State, Nigeria</td>
                                            <th>TO</th>
                                            <td>Not specified</td>
                                        </tr>
                                        <tr>
                                            <th>Arrival Date</th>
                                            <td>Not specified</td>
                                            <th>Offloading Date</th>
                                            <td>Not specified</td>

                                        </tr>

                                        <tr>
                                            <th>Final Destination</th>
                                            <td>Not specified</td>
                                        </tr>

                                    </table>

                                    <h3>Goods Details</h3>
                                    <table>
                                        <tr>
                                            <th>Goods Description</th>
                                            <th>Goods Size</th>
                                            <th>Unit Type</th>
                                            <th>Unit Weight</th>
                                            <th>Total QTY</th>
                                            <th>Sound</th>
                                            <th>Other</th>
                                        </tr>
                                        <tr>
                                            <td>WIRE</td>
                                            <td>1X20FT</td>
                                            <td>Container</td>
                                            <td>Not specified</td>
                                            <td>Not specified</td>
                                            <td>Not specified</td>
                                            <td>Not specified</td>

                                        </tr>
                                    </table>

                                    <div class="remarks">
                                        <div class="trigger_remark"><i class="fa fa-comment"></i></div>
                                        <div class="popup_remark">
                                            <label><input type="radio" name="remark" value="Very Good"> Very
                                                Good</label>
                                            <label><input type="radio" name="remark" value="Good"> Good</label>
                                            <label><input type="radio" name="remark" value="Not Good"> Not Good</label>
                                        </div>
                                        <h3>Remarks</h3>
                                        <textarea placeholder="remark" id="remarkv" readonly></textarea>
                                    </div>




                                    <h3>Driver Info</h3>
                                    <table>
                                        <tr>
                                            <th>Driver’s Name</th>
                                            <td>BABA</td>
                                            <th>Title</th>
                                            <td>Not specified</td>
                                        </tr>
                                        <tr>
                                            <th>truck/vechicle no.</th>
                                            <td>Not specified</td>
                                            <!-- <th>Phone Number</th>
                                            <td>7078691299</td> -->
                                        </tr>


                                    </table>
                                    <h3>Dispatch & Reciever Info</h3>
                                    <table>
                                        <tr>
                                            <th>Dispatched by</th>
                                            <td>Not specified</td>
                                            <th>Recieved by</th>
                                            <td>Not specified</td>
                                        </tr>
                                        <tr>
                                            <th>Title</th>
                                            <td>Not specified</td>
                                            <th>Title</th>
                                            <td>Not specified</td>
                                        </tr>
                                        <!-- <tr>
                                            <th>Signature and Date</th>
                                            <td>Not specified</td>
                                            <th>Signature and Date</th>
                                            <td>Not specified</td>
                                        </tr> -->
                                    </table>




                                    <div class="stamp_wrapper">
                                        <div class="stamp_p s1" onclick="activateStamp(this)">
                                            <div class="title">Reciever Info (for loading)</div>
                                            <div class="sign1"></div>
                                            <div class="stamp1"></div>
                                        </div>
                                        <div class="stamp_p s2" onclick="activateStamp(this)">
                                            <div class="title">Local Agent Info (for loading)</div>
                                            <div class="sign1"></div>
                                            <div class="stamp1"></div>
                                        </div>
                                    </div>

                                    <div class="footer">
                                        <div class="fot1">


                                        </div>

                                        <div class="fot2">
                                            <div class="fort_fot ">
                                                <!-- <h3>Terms and Conditions</h3> -->
                                                <p> <span class="bold">Phone: </span> (234) 909 9710 778, (234) 818 4792
                                                    309
                                                </p>
                                                <p> <span class="bold">website: </span> https://libracircle.com</p>
                                                <p> <span class="bold">Email: </span> info@libracircle.com</p>
                                                <p class="upt"> <span class="bold">TIN: </span> 02624825-0001 | RC-32913
                                                    |
                                                    VAT
                                                    IKV0600232913</p>

                                            </div>


                                        </div>

                                    </div>


                                </div>
                            </div>



                            <div class="sign_modal">
                                <form class="sign_wrapper">
                                    <div class="sign_view"></div>
                                    <div class="op_msg">Are you sure you want to sign this document?</div>

                                    <div class="sign_opt">
                                        <button onclick="handleSignSubmition()" type="submit">Yes</button>
                                        <button class="no" onclick="handleCloseModal()" type="button">No</button>
                                    </div>
                                    <p class="sign_msg"></p>
                                </form>

                            </div>

                            <div class="stamp_modal">
                                <form class="stamp_wrapper" id="stampForm" action="">
                                    <input type="hidden" name="record_id" value="12345"> <!-- Example Record ID -->
                                    <input type="hidden" name="user_id" value="67890"> <!-- Example User ID -->

                                    <div class="stamp_view">
                                        <img src="./stamp1.svg" alt="" id="stampImage">
                                    </div>
                                    <div class="op_msg">Are you sure you want to stamp this document?</div>
                                    <small class="notexs"> <span>Note:</span> Time stamp is based on server time and not
                                        your device time</small>
                                    <div class="stamp_opt">
                                        <button type="submit">Yes</button>
                                        <button class="no" type="button" onclick="handleCloseModal()">No</button>
                                    </div>
                                    <p class="stamp_msg"></p>
                                </form>
                            </div>

                            <div class="actions_op noshowp">

                                <!-- <button type="button" onclick="window.print()"> <i class="fa-solid fa-print"></i>
                                    Print</button> -->
                                <div class="dropdown">
                                    <button type="button"> <i class="fa-solid fa-download"></i> Download</button>
                                    <div class="dropdown-content">
                                        <button onclick="downloadWaybillAsPDF()"><i class="fa fa-file"></i> As
                                            PDF</button>
                                        <button onclick="downloadWaybillAsImage()"><i class="fa fa-image"></i> As
                                            Image</button>
                                    </div>
                                </div>
                                <button type="button" onclick="shareWaybillAsImage()"> <i
                                        class="fa-sharp fa-solid fa-share-from-square"></i>Share</button>
                                <button type="button" class="collapse_action" title="collapse action"> <i
                                        class="fa fa-angle-up"></i></button>
                            </div>
                        </div>
                        <div id="waybill_p2" class="tab">
                            <!-- 
                            <div class="scale-container">
                                <button type="button" onclick="handleSign()" class="bt1op" title="Sign"> <i
                                        class="fa-sharp fa-solid fa-pen-nib"></i>
                                </button>
                                <button type="button" onclick="handleStamp()" class="bt2op" title="Stamp"> <i
                                        class="fa-sharp fa-solid fa-stamp"></i>
                                </button>
                                <button onclick="panzoom.zoomIn()" title="Zoom In"> <i class="fa fa-plus"></i> </button>
                                <button onclick="panzoom.zoomOut()" title="Zoom Out">
                                    <div class="fa fa-minus" title="Reset Zoom"></div>
                                </button>
                                <button onclick="panzoom.reset()"><i class="fa fa-refresh"></i></button>
                            </div> -->
                            <div id="zoom-container2">
                                <div class="waybill_container2" id="waybill_special" data-action="zoom2">



                                    <div class="header">
                                        <div class="logo_cont consignee_logo">
                                            <div class="logo">
                                                <img src="./ing.png" alt="">
                                            </div>
                                        </div>
                                        <div class="logo_cont js-left">
                                            <div class="logo">
                                                <img src="./ing.png" alt="">
                                            </div>
                                        </div>

                                    </div>
                                    <h2 class="title2">WAYBILL <span class="waybill_num">FMCG/2024/0001</span></h2>
                                    <h3>DISPATCH SECTION</h3>
                                    <div class="patner_cont">
                                        <h3>Consignee's Name & Address</h3>
                                        <p><span class="bold">Client:</span> <span class="p_info">MOZUK MEDIEQUIP &
                                                COMMODITIES
                                                SOLUTIONS LIMITED</span></p>
                                        <p><span class="bold">Address:</span>
                                            <span class="add_info">Gecko Warehouse, Arepo, Arepo B/Stop, off
                                                Lagos Ibadan Expressway.</span>
                                        </p>
                                    </div>



                                    <h3>Transporter Information</h3>
                                    <table>
                                        <tr>
                                            <th>Transporter's Name</th>
                                            <td>Libra Circle</td>
                                            <th>Freight Forwarder</th>
                                            <td>Not specified</td>
                                        </tr>

                                    </table>

                                    <h3>Waybill Details</h3>
                                    <table>
                                        <tr>
                                            <th>BL Number</th>
                                            <td>PNG000602-240418068/AGLN0806[SHPL40620400]</td>
                                            <th>Reference</th>
                                            <td>Not specified</td>

                                        </tr>
                                        <tr>
                                            <th>Container No.</th>
                                            <td>PCIU1924760</td>
                                            <th>Container Seal No.</th>
                                            <td>Not specified</td>

                                        </tr>
                                        <tr>
                                            <th>Sealed (Yes/No)</th>
                                            <td>Not specified</td>
                                            <th>Tracker Found (Yes/No)</th>
                                            <td>Not specified</td>

                                        </tr>

                                    </table>

                                    <h3>Shipment Information</h3>
                                    <table>
                                        <tr>
                                            <th>CLIENT REF</th>
                                            <td>xxx112</td>
                                            <th>CONSIGNEE</th>
                                            <td>BURN STOVES NIGERIA LIMITED</td>
                                        </tr>
                                        <tr>
                                            <th>FROM</th>
                                            <td>Burn Nigeria Limited, Bala Dawakin Industrial Layout, Charo junction,
                                                Kano
                                                State, Nigeria</td>
                                            <th>TO</th>
                                            <td>Not specified</td>
                                        </tr>
                                        <tr>
                                            <th>Loaded Date</th>
                                            <td>Not specified</td>

                                            <th>Arrival Date</th>
                                            <td>Not specified</td>
                                        </tr>

                                        <tr>
                                            <th>Offloading Date</th>
                                            <td>Not specified</td>
                                            <th>Final Destination</th>
                                            <td>Not specified</td>
                                        </tr>

                                    </table>

                                    <h3>Goods Details</h3>
                                    <table>
                                        <tr>
                                            <th>Goods Description</th>
                                            <th>Goods Size & <br /> Seal No (Origin)</th>
                                            <th>Unit Type</th>
                                            <th>QTY Recieved<br /> (Origin)</th>
                                            <th>QTY Recieved<br /> (Dest.)</th>
                                            <th>Difference<br /> (Origin - Destination)</th>
                                        </tr>
                                        <tr>
                                            <td>WIRE</td>
                                            <td>1X20FT</td>
                                            <td>Container</td>
                                            <td>Not specified</td>
                                            <td>Not specified</td>
                                            <td>Not specified</td>

                                        </tr>
                                    </table>

                                    <div class="remarks">
                                        <div class="trigger_remark"><i class="fa fa-comment"></i></div>
                                        <div class="popup_remark">
                                            <label><input type="radio" name="remark" value="Very Good"> Very
                                                Good</label>
                                            <label><input type="radio" name="remark" value="Good"> Good</label>
                                            <label><input type="radio" name="remark" value="Not Good"> Not Good</label>
                                        </div>
                                        <h3>Remarks</h3>
                                        <textarea placeholder="remark" id="remarkv" readonly></textarea>
                                    </div>
                                    <h3>Comment</h3>
                                    <textarea id="comment"></textarea>



                                    <h3>Driver Info</h3>
                                    <table>
                                        <tr>
                                            <th>Driver’s Name</th>
                                            <td>BABA</td>
                                            <th>Title</th>
                                            <td>Not specified</td>
                                        </tr>
                                        <tr>
                                            <!-- <th>truck/vechicle no.</th>
                                            <td>Not specified</td> -->
                                            <!-- <th>Phone Number</th>
                                            <td>7078691299</td> -->
                                        </tr>


                                    </table>
                                    <h3>Dispatch & Reciever Info</h3>
                                    <table>
                                        <tr>
                                            <th>Dispatched by</th>
                                            <td>Not specified</td>
                                            <th>Recieved by</th>
                                            <td>Not specified</td>
                                        </tr>
                                        <tr>
                                            <th>Title</th>
                                            <td>Not specified</td>
                                            <th>Title</th>
                                            <td>Not specified</td>
                                        </tr>
                                        <!-- <tr>
                                            <th>Signature and Date</th>
                                            <td>Not specified</td>
                                            <th>Signature and Date</th>
                                            <td>Not specified</td>
                                        </tr> -->
                                    </table>






                                    <div class="footer">
                                        <div class="fot1">


                                        </div>

                                        <div class="fot2">
                                            <div class="fort_fot ">
                                                <!-- <h3>Terms and Conditions</h3> -->
                                                <p> <span class="bold">Phone: </span> (234) 909 9710 778, (234) 818 4792
                                                    309
                                                </p>
                                                <p> <span class="bold">website: </span> https://libracircle.com</p>
                                                <p> <span class="bold">Email: </span> info@libracircle.com</p>
                                                <p class="upt"> <span class="bold">TIN: </span> 02624825-0001 | RC-32913
                                                    |
                                                    VAT
                                                    IKV0600232913</p>

                                            </div>


                                        </div>

                                    </div>

                                    <div class="stamp_p s1" onclick="activateStamp(this)">
                                        <div class="title">Reciever Info (for loading)</div>
                                        <div class="sign1"></div>
                                        <div class="stamp1"></div>
                                    </div>
                                    <div class="stamp_p s2" onclick="activateStamp(this)">
                                        <div class="title">Local Agent Info (for loading)</div>
                                        <div class="sign1"></div>
                                        <div class="stamp1"></div>
                                    </div>
                                </div>
                            </div>



                            <div class="sign_modal">
                                <form class="sign_wrapper">
                                    <div class="sign_view"></div>
                                    <div class="op_msg">Are you sure you want to sign this document?</div>

                                    <div class="sign_opt">
                                        <button onclick="handleSignSubmition()" type="submit">Yes</button>
                                        <button class="no" onclick="handleCloseModal()" type="button">No</button>
                                    </div>
                                    <p class="sign_msg"></p>
                                </form>

                            </div>

                            <div class="stamp_modal">
                                <form class="stamp_wrapper" id="stampForm" action="">
                                    <input type="hidden" name="record_id" value="12345"> <!-- Example Record ID -->
                                    <input type="hidden" name="user_id" value="67890"> <!-- Example User ID -->

                                    <div class="stamp_view">
                                        <img src="./stamp1.svg" alt="" id="stampImage">
                                    </div>
                                    <div class="op_msg">Are you sure you want to stamp this document?</div>
                                    <small class="notexs"> <span>Note:</span> Time stamp is based on server time and not
                                        your device time</small>
                                    <div class="stamp_opt">
                                        <button type="submit">Yes</button>
                                        <button class="no" type="button" onclick="handleCloseModal()">No</button>
                                    </div>
                                    <p class="stamp_msg"></p>
                                </form>
                            </div>

                            <div class="actions_op noshowp">

                                <!-- <button type="button" onclick="window.print()"> <i class="fa-solid fa-print"></i>
                                    Print</button> -->
                                <div class="dropdown">
                                    <button type="button"> <i class="fa-solid fa-download"></i> Download</button>
                                    <div class="dropdown-content">
                                        <button onclick="downloadWaybillAsPDF()"><i class="fa fa-file"></i> As
                                            PDF</button>
                                        <button onclick="downloadWaybillAsImage()"><i class="fa fa-image"></i> As
                                            Image</button>
                                    </div>
                                </div>
                                <button type="button" onclick="shareWaybillAsImage()"> <i
                                        class="fa-sharp fa-solid fa-share-from-square"></i>Share</button>
                                <button type="button" class="collapse_action" title="collapse action"> <i
                                        class="fa fa-angle-up"></i></button>
                            </div>
                        </div>

                        <!-- Hidden File Input -->
                        <input type="file" id="imageInput" accept="image/*" style="display: none;"
                            onchange="previewImage()">

                        <!-- Modal for Image Preview & Editing -->
                        <div id="imageModal" class="modal">
                            <div class="modal-content">
                                <span class="close" onclick="closeModal()">&times;</span>
                                <h3 id="modalTitle"></h3> <!-- Show image type (Driver/Truck) -->
                                <h4 id="fileName"></h4> <!-- Display file name -->
                                <img id="previewImage" src="" alt="Image Preview">
                                <button onclick="document.getElementById('imageInput').click()">Change
                                    Image</button>
                                <button onclick="saveImage()">Save</button>
                                <button class="media_p" onclick="downloadImage()" title="Download">
                                    <i class="fa fa-download"></i>
                                </button>
                                <button class="media_p" onclick="printImage()" title="Print">
                                    <i class="fa fa-print"></i>
                                </button>
                                <button class="media_p" onclick="shareImage()" title="Share">
                                    <i class="fa fa-share-alt"></i>
                                </button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div class="settings-container" style="display: none;">
                <div class="sidebar">
                    <button class="back-btn opi" onclick="goBack1()" style="color: black;">← Back</button>

                    <h2> Settings</h2>

                    <div class="menu-item" onclick="showTab('generalsettings')"><i class="fas fa-cogs"></i> General
                    </div>
                    <!-- <div class="submenu" id="generalSubmenu">
                        <a onclick="showTab('stam')"><i class="fas fa-file-alt"></i> STAM</a>
                        <a onclick="showTab('signature')"><i class="fas fa-pen-nib"></i> Signature</a>
                    </div> -->

                    <div class="menu-item" onclick="showTab('users')"><i class="fas fa-user-plus"></i> Users</div>
                    <!-- <div class="submenu" id="subUserSubmenu">
                        <a onclick="showTab('createSubUser')"><i class="fas fa-user-plus"></i>Create Sub User</a>
                        <a onclick="showTab('manageSubUsers')"><i class="fas fa-user-edit"></i> Manage Sub Users</a>
                    </div> -->

                    <div class="menu-item" onclick="showTab('facility')"><i class="fas fa-plus-square"></i>
                        Facilities
                    </div>
                    <!-- <div class="submenu" id="facilitySubmenu">
                        <a><i class="fas fa-plus-square"></i> Create Facility</a>
                        <a><i class="fas fa-tasks"></i> Manage Facility</a>
                    </div> -->

                    <button class="logout-btn"><i class="fas fa-sign-out-alt"></i> Log Out</button>
                </div>

                <div class="main-content">
                    <div id="welcome" class="tab-content active">
                        <button class="back-btn " onclick="goBack()" style="display: none;">← Back</button>
                        <h1>Welcome to Settings</h1>
                        <p>Select an item from the menu to view or edit settings.</p>
                    </div>

                    <div id="generalsettings" class="tab-content">

                        <h1><button class="back-btn" onclick="goBack()" style="display: none;">← Back</button>GENERAL
                        </h1>
                        <h1>Stamp</h1>
                        <form>
                            <input type="hidden" name="clientid">
                            <div class="form-group floating-label">
                                <input id="companyName" type="text" placeholder=" " required />
                                <label for="companyName">Company Name</label>
                            </div>
                            <div class="form-group floating-label">
                                <input id="companySlogan" type="text" placeholder=" " required />
                                <label for="CompnaySlogan">Company Slogan</label>
                            </div>
                            <div class="form-group floating-label">
                                <select id="stampOption" required>
                                    <option value="" disabled selected hidden></option>
                                    <option value="paid">Paid</option>
                                    <option value="recieved">recieved</option>
                                    <option value="stamp">stamp</option>
                                </select>
                                <label for="signatureOption">Select stamp text</label>
                            </div>
                            <div class="form-group">
                                <button type="submit" class="submit-btn">Save Info</button>

                            </div>
                        </form>

                        <!-- <h1>Signature</h1>
                        <form action="">
                            <div class="form-group floating-label">
                                <input type="text" id="firstName" value="Administator" readonly placeholder=" " />
                                <label for="firstName">First Name</label>
                            </div>

                            <div class="form-group floating-label">
                                <input type="text" id="lastName" value="Libra circle" readonly placeholder=" " />
                                <label for="lastName">Last Name</label>
                            </div>

                            <div class="form-group floating-label">
                                <select id="signatureOption" required>
                                    <option value="" disabled selected hidden></option>
                                    <option value="sig1">Signature Style 1</option>
                                    <option value="sig2">Signature Style 2</option>
                                    <option value="sig3">Signature Style 3</option>
                                </select>
                                <label for="signatureOption">Select Signature Style</label>
                            </div>

                            <div class="form-group"><button class="submit-btn">Save Signature</button></div>

                        </form> -->
                    </div>



                    <div id="users" class="tab-content">
                        <button class="back-btn" onclick="goBack()" style="display: none;">← Back</button>
                        <h1>Create User</h1>
                        <form action="">
                            <div class="form-group floating-label">
                                <input type="text" id="subFirstName" placeholder=" " required />
                                <label for="subFirstName">First Name</label>
                            </div>

                            <div class="form-group floating-label">
                                <input type="text" id="subLastName" placeholder=" " required />
                                <label for="subLastName">Last Name</label>
                            </div>


                            <input type="hidden" id="clientId" value="123456" />

                            <div class="form-group floating-label">
                                <select id="subSignature" required>
                                    <option value="" disabled selected hidden></option>
                                    <option value="sig1">Signature Style 1</option>
                                    <option value="sig2">Signature Style 2</option>
                                    <option value="sig3">Signature Style 3</option>
                                </select>
                                <label for="subSignature">Select Signature Style</label>
                            </div>
                            <div class="form-group floating-label">
                                <select id="roleOption" required>
                                    <option value="" disabled selected hidden></option>
                                    <option value="sig1">Admin</option>
                                    <option value="sig2">Sub user 1</option>
                                    <option value="sig3">Sub user 2</option>
                                </select>
                                <label for="signatureOption">Select Role</label>
                            </div>
                            <div class="form-group">
                                <button class="submit-btn">Create User</button>
                            </div>
                        </form>

                        <div class="table-container" style="margin-top: 20px;">
                            <h1>Existing Users</h1>
                            <!-- Table -->
                            <table id="subUserTable" class="display">
                                <thead>
                                    <tr>
                                        <th>First Name</th>
                                        <th>Last Name</th>
                                        <th>Role</th>
                                        <th>Access Code</th>
                                        <th>Signature</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Chinedu</td>
                                        <td>Okafor</td>
                                        <td>Admin</td>
                                        <td>CHN123</td>
                                        <td><img src="https://via.placeholder.com/50x30?text=Sign" alt="Signature"
                                                class="signature-img"></td>
                                        <td><button onclick="openModal(event, 'CHN123')" class="more-btn">⋮</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Amina</td>
                                        <td>Bello</td>
                                        <td>Sub Admin</td>
                                        <td>AMN456</td>
                                        <td><img src="https://via.placeholder.com/50x30?text=Sign" alt="Signature"
                                                class="signature-img"></td>
                                        <td><button onclick="openModal(event, 'AMN456')" class="more-btn">⋮</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Emeka</td>
                                        <td>Uche</td>
                                        <td>Sub Admin</td>
                                        <td>EMK789</td>
                                        <td><img src="https://via.placeholder.com/50x30?text=Sign" alt="Signature"
                                                class="signature-img"></td>
                                        <td><button onclick="openModal(event, 'EMK789')" class="more-btn">⋮</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Yetunde</td>
                                        <td>Adeyemi</td>
                                        <td>user</td>
                                        <td>YET321</td>
                                        <td><img src="https://via.placeholder.com/50x30?text=Sign" alt="Signature"
                                                class="signature-img"></td>
                                        <td><button onclick="openModal(event, 'YET321')" class="more-btn">⋮</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Segun</td>
                                        <td>Ogunleye</td>
                                        <td>user</td>
                                        <td>SEG654</td>
                                        <td><img src="https://via.placeholder.com/50x30?text=Sign" alt="Signature"
                                                class="signature-img"></td>
                                        <td><button onclick="openModal(event, 'SEG654')" class="more-btn">⋮</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>


                            <!-- Modal -->
                            <!-- Modal -->
                            <div id="actionModal" class="cps_action-modal-overlay cps_action-modal-hidden">
                                <div class="cps_action-modal-content">
                                    <ul class="cps_action-modal-actions">
                                        <li><button onclick="editAction()">Edit</button></li>
                                        <li><button onclick="deleteAction()">Delete</button></li>
                                        <li><button onclick="manageFacility()">Manage Facility</button></li>
                                        <li><button onclick="revokeAccess()">Revoke Access</button></li>
                                    </ul>

                                </div>
                            </div>


                        </div>

                    </div>

                    <div id="facility" class="tab-content">
                        <button class="back-btn" onclick="goBack()" style="display: none;">← Back</button>
                        <h1>Create Facility</h2>

                            <form>
                                <div class="form-group floating-label">
                                    <input type="text" id="facilityName" placeholder=" " required />
                                    <label for="facilityName">Facility Name</label>
                                </div>

                                <div class="form-group floating-label">
                                    <input type="text" id="facilityType" placeholder=" " required />
                                    <label for="facilityType">Facility Type</label>
                                </div>

                                <div class="form-group floating-label">
                                    <input type="text" id="address" placeholder=" " required />
                                    <label for="address">Address</label>
                                </div>

                                <div class="form-group floating-label">
                                    <input type="text" id="latitude" placeholder=" " required />
                                    <label for="latitude">Latitude</label>
                                </div>

                                <div class="form-group floating-label">
                                    <input type="text" id="longitude" placeholder=" " required />
                                    <label for="longitude">Longitude</label>
                                </div>

                                <div class="form-group">
                                    <button type="submit" class="submit-btn">Save Facility</button>
                                </div>


                            </form>
                            <div class="table-container" style="margin-top: 20px;">
                                <h1>Existing Facility</h1>
                                <table id="facilityTable" class="display">
                                    <thead>
                                        <tr>
                                            <th>Facility Name</th>
                                            <th>Facility Type</th>
                                            <th>Address</th>
                                            <th>Latitude</th>
                                            <th>Longitude</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Apapa</td>
                                            <td>storage</td>
                                            <td>No 4 Apapa way</td>
                                            <td>L123456</td>
                                            <td>L345678</td>
                                            <td><button onclick="openModal(event, 'pp123')" class="more-btn">⋮</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Apapa</td>
                                            <td>storage</td>
                                            <td>No 4 Apapa way</td>
                                            <td>L123456</td>
                                            <td>L345678</td>
                                            <td><button onclick="openModal(event, 'pp134')" class="more-btn">⋮</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Apapa</td>
                                            <td>storage</td>
                                            <td>No 4 Apapa way</td>
                                            <td>L123456</td>
                                            <td>L345678</td>
                                            <td><button onclick="openModal(event, 'pp135')" class="more-btn">⋮</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Apapa</td>
                                            <td>storage</td>
                                            <td>No 4 Apapa way</td>
                                            <td>L123456</td>
                                            <td>L345678</td>
                                            <td><button onclick="openModal(event, 'pp136')" class="more-btn">⋮</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Apapa</td>
                                            <td>storage</td>
                                            <td>No 4 Apapa way</td>
                                            <td>L123456</td>
                                            <td>L345678</td>
                                            <td><button onclick="openModal(event, 'pp137')" class="more-btn">⋮</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>


                            <div id="actionModal2" class="cps_action-modal-overlay cps_action-modal-hidden">
                                <div class="cps_action-modal-content">
                                    <ul class="cps_action-modal-actions">
                                        <li><button onclick="editAction()">Edit</button></li>
                                        <li><button onclick="deleteAction()">Delete</button></li>
                                        <li><button onclick="manageFacility()">Manage Facility</button></li>
                                        <li><button onclick="revokeAccess()">Revoke Access</button></li>
                                    </ul>

                                </div>
                            </div>
                    </div>






                </div>
            </div>

        </main>

    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#subUserTable').DataTable({
                responsive: true
            });
        });

        $(document).ready(function () {
            $('#facilityTable').DataTable({
                responsive: true
            });
        });

        // Get modal element
        const actionModal = document.getElementById('actionModal');
        const actionModal2 = document.getElementById('actionModal2');

        // Function to open the modal and position it next to the button
        function openModal(event, userCode) {
            // alert('me')
            const button = event.target; // Get the clicked button

            // Get the button's position on the screen
            const rect = button.getBoundingClientRect();

            // Set the modal's position based on the button's position
            actionModal.style.left = `${rect.right + window.scrollX}px`; // Position it right next to the button
            actionModal.style.top = `${rect.top + window.scrollY}px`;  // Align it with the button's vertical position
            actionModal2.style.left = `${rect.right + window.scrollX}px`; // Position it right next to the button
            actionModal2.style.top = `${rect.top + window.scrollY}px`;  // Align it with the button's vertical position

            // Make the modal visible
            actionModal.classList.remove('cps_action-modal-hidden');
            actionModal2.classList.remove('cps_action-modal-hidden');
        }

        // Function to close the modal
        function closeModal() {
            actionModal.classList.add('cps_action-modal-hidden');
            actionModal2.classList.add('cps_action-modal-hidden');
        }

        // Action button functions
        function editAction() {
            closeModal();
            alert('Edit action clicked!');
        }

        function deleteAction() {
            closeModal();
            alert('Delete action clicked!');
        }

        function manageFacility() {
            closeModal();
            alert('Manage Facility action clicked!');
        }

        function revokeAccess() {
            closeModal();
            alert('Revoke Access action clicked!');
        }

        // Optional: Close modal if clicking outside the content
        window.addEventListener('click', function (event) {
            if (event.target === actionModal) {
                closeModal();
            } else if (event.target === actionModal2) {
                closeModal()
            }
        });

        // Close the modal when clicking outside the modal content
        const modalOverlay = document.querySelector('.cps_action-modal-overlay');
        modalOverlay.addEventListener('click', function (event) {
            if (event.target !== modalOverlay) {
                modalOverlay.classList.add('cps_action-modal-hidden'); // Hide the modal
            }
        });





        const toggleSidebar = () => {
            const asidenav = document.querySelector(".epod_cont aside");
            asidenav.classList.add('shownav')
        }

        const handleCloseSidebar = () => {
            const asidenav = document.querySelector(".epod_cont aside");
            asidenav.classList.remove('shownav')
        }




        const trigger = document.querySelector('.trigger_remark');
        const popup = document.querySelector('.popup_remark');
        const textarea = document.querySelector('#remarkv');

        // Toggle pop-up
        trigger.addEventListener('click', () => {
            popup.style.display = popup.style.display === 'block' ? 'none' : 'block';
        });

        // Hide popup when clicking outside
        document.addEventListener('click', (event) => {
            if (!trigger.contains(event.target) && !popup.contains(event.target)) {
                popup.style.display = 'none';
            }
        });

        // Update textarea when a remark is selected
        document.querySelectorAll('.popup_remark input').forEach(radio => {
            radio.addEventListener('change', (event) => {
                textarea.value = event.target.value;
                popup.style.display = 'none';
            });
        });


        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });

            document.getElementById(tabId).classList.add('active');

            // Mobile behavior
            if (window.innerWidth < 545) {
                document.querySelector('.main-content').classList.add('active');
                document.querySelector('.sidebar').classList.add('hidden');
                document.querySelector('.back-btnop').style.display = 'inline-block';
            }
        }

        function switchToSettings() {
            document.querySelector('.epod_contents').style.display = 'none';
            document.querySelector('.settings-container').style.display = 'flex'; // Flex since your settings use flex
        }

        function goBack() {
            document.querySelector('.main-content').classList.remove('active');
            document.querySelector('.sidebar').classList.remove('hidden');
            document.querySelector('.back-btn').style.display = 'none';
        }

        function goBack1() {
            document.querySelector('.settings-container').style.display = 'none';
            document.querySelector('.epod_contents').style.display = 'flex';
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/share-this/1.3.1/share-this.js"
        integrity="sha512-YQH3AWzoNd5UBgAzelMJ0L74JzsE1RfD7zrTDfveB5Xm5j9PBCU+Q2tD4RavX2iVVAt4iJ/gi1mSRCbX/X55pw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>

        document.addEventListener("DOMContentLoaded", function () {
            const dataContainer = document.getElementById('dataContainer');
            const convertButton = document.getElementById('convertToTable');
            const convertButton2 = document.getElementById('convertToBoxes');
            const epodDetails = document.querySelector('.epod_cont main .epod_details');
            const loadingAnimation = document.querySelector('.loading-animation');

            let epodDashBoxs = document.querySelectorAll('.epod_dash_box'); // Capture boxes initially
            let originalHTML = dataContainer.innerHTML; // Store original layout

            // Handle side toggling
            const handleSideToggle = () => {
                epodDetails.classList.toggle('show');
                epodDashBoxs.forEach((b) => b.classList.remove('active'));
                loadingAnimation.classList.add('show');

                setTimeout(() => {
                    loadingAnimation.classList.remove('show');
                }, 1000);

            };

            // Attach event listeners for epodDashBoxs
            function attachBoxEventListeners() {
                epodDashBoxs = document.querySelectorAll('.epod_dash_box'); // Refresh box list

                epodDashBoxs.forEach((b) => b.classList.remove('active')); // Remove active initially

                epodDashBoxs.forEach((box) => {
                    box.addEventListener('click', () => {
                        epodDashBoxs.forEach((b) => b.classList.remove('active'));
                        box.classList.add('active');
                        epodDetails.classList.add('show');
                    });
                });
            }

            // Attach event listeners for tabs
            function attachTabEventListeners() {
                const tabs = document.querySelectorAll(".epod_navlinks button");
                const contents = document.querySelectorAll(".epod-tab_contents .tab");

                tabs.forEach(tab => {
                    tab.addEventListener("click", function () {
                        tabs.forEach(t => t.classList.remove("current"));
                        contents.forEach(content => content.classList.remove("active"));

                        this.classList.add("current");

                        const tabId = this.id;
                        document.querySelector(`.epod-tab_contents #${tabId}`)?.classList.add("active");
                    });
                });
            }

            convertButton.addEventListener('click', function () {
                dataContainer.classList.toggle('table-view');

                if (dataContainer.classList.contains('table-view')) {
                    let tableHTML = `
        <table>
            <thead>
                <tr>
                    <th>Action</th>
                    <th>Truck ID</th>
                    <th>Status</th>
                    <th>Time</th>
                    <th>Day</th>
                    <th>Destination</th>
                </tr>
            </thead>
            <tbody>`;

                    // Build table rows from boxes
                    const dashBoxes = dataContainer.querySelectorAll('.epod_dash_box');
                    dashBoxes.forEach(box => {
                        const trackId = box.querySelector('.track_id')?.textContent.trim() || '';
                        const statusText = box.querySelector('.status p')?.textContent.trim() || '';
                        const time = box.querySelector('.time')?.textContent.trim() || '';
                        const day = box.querySelector('.day')?.textContent.trim() || '';

                        // Detect in-transit status
                        const isInTransit = box.classList.contains('in-transit') ||
                            (box.dataset.intransit && box.dataset.intransit === "true");

                        // Collect destinations
                        const destinations = Array.from(box.querySelectorAll('.route')).map(route => {
                            const routeP = route.querySelector('p');
                            return routeP ? routeP.textContent.trim() : route.textContent.trim();
                        }).join(', ') || '';

                        // Action button for details
                        const actionBtnTable = `<button type="button" class="btn-primary3" onclick="handleSideToggle()">Details</button>`;

                        // Status indicator
                        const statscls = box.querySelector('.status').classList;
                        const statusIndicator = `<div class="${statscls}" style="display: flex; align-items: center; gap: 5px;">
                                        <div></div>
                                        <p>${statusText}</p>
                                    </div>`;

                        // Add row to table
                        tableHTML += `
                <tr data-intransit="${isInTransit}" data-route="${statusText.toLowerCase()}">
                    <td>${actionBtnTable}</td>
                    <td>${trackId}</td>
                    <td>${statusIndicator}</td>
                    <td>${time}</td>
                    <td>${day}</td>
                    <td class="text-wrap">${destinations}</td>
                </tr>`;
                    });

                    tableHTML += '</tbody></table>';
                    dataContainer.innerHTML = tableHTML;

                    // Disable this button, enable back button
                    convertButton.disabled = true;
                    convertButton2.disabled = false;

                    // 🔥 Reapply the active filter to the table view
                    applyFilter();
                }
            });

            // Back to grid view
            convertButton2.addEventListener('click', function () {
                dataContainer.classList.toggle('table-view');
                dataContainer.innerHTML = originalHTML;

                convertButton.disabled = false;
                convertButton2.disabled = true;

                // Reattach listeners for grid mode
                attachTabEventListeners();
                attachBoxEventListeners();

                // 🔥 Reapply the active filter to grid view
                applyFilter();
            });

            // Attach initial listeners
            attachTabEventListeners();
            attachBoxEventListeners();

        });


        function searchBoxes() {
            let input = document.getElementById("searchInput").value.toUpperCase();
            let isTableView = document.getElementById("dataContainer").classList.contains("table-view");

            if (isTableView) {
                // Searching in table view
                let rows = document.querySelectorAll("#dataContainer table tbody tr");

                rows.forEach(row => {
                    let trackId = row.children[0].innerText.toUpperCase();
                    let blNo = row.children[5].innerText.toUpperCase();

                    if (trackId.includes(input) || blNo.includes(input)) {
                        row.style.display = "";
                    } else {
                        row.style.display = "none";
                    }
                });

            } else {
                // Searching in box view
                let boxes = document.querySelectorAll(".epod_dash_box");

                boxes.forEach(box => {
                    let trackId = box.querySelector(".track_id")?.innerText.toUpperCase() || "";
                    let blNo = box.querySelector(".bl_no")?.innerText.toUpperCase() || "";

                    if (trackId.includes(input) || blNo.includes(input)) {
                        box.style.display = "block";
                        box.style.maxWidth = "fit-content";
                    } else {
                        box.style.display = "none";
                    }
                });
            }
        }

        // Enable search on input keyup
        document.getElementById("searchInput").addEventListener("keyup", searchBoxes);

        document.addEventListener("DOMContentLoaded", function () {
            const filters = document.querySelectorAll(".list.filter");
            const dataContainer = document.getElementById("dataContainer");

            const EN_ROUTE_KEY = "en route";
            const IN_TRANSIT_KEY = "Completed"; // The filter key for In Transit
            let activeFilter = null;
            let inTransitState = null;
            // null = off, true = show in-transit only, false = show not-in-transit only

            const filterStatusMap = {
                "en route": "en route",
                "Pending": "Awaiting takeoff",
                "Completed": "In transit",
                "Cancelled": "Arrived",
                "In Progress": "Completed"
            };

            function getItemState(item, isTableView) {
                const routeStatus = (
                    isTableView
                        ? (item.dataset.route || item.children[1]?.innerText || "")
                        : (item.dataset.route || item.querySelector(".status p")?.innerText || "")
                ).trim().toLowerCase();

                const dataFlag = (item.dataset.intransit || "").toLowerCase();
                const classFlag = item.classList.contains("in-transit");
                const movementText = (
                    isTableView
                        ? (item.dataset.movement || item.children[2]?.innerText || "")
                        : (item.dataset.movement || item.querySelector(".movement p")?.innerText || "")
                ).trim().toLowerCase();

                const inTransit = classFlag || dataFlag === "true" || /in\s*transit/i.test(movementText);
                return { routeStatus, inTransit };
            }

            function applyFilter() {
                const isTableView = dataContainer.classList.contains("table-view");
                const items = isTableView
                    ? document.querySelectorAll("#dataContainer table tbody tr")
                    : document.querySelectorAll(".epod_dash_box");

                items.forEach(item => {
                    const { routeStatus, inTransit } = getItemState(item, isTableView);
                    let show = true;

                    if (activeFilter !== null) {
                        const expected = (filterStatusMap[activeFilter] || activeFilter).toLowerCase();
                        show = routeStatus === expected;

                        if (activeFilter === EN_ROUTE_KEY && inTransitState !== null) {
                            // true = in-transit only, false = not in-transit only
                            show = show && (inTransit === inTransitState);
                        }
                    }

                    item.style.display = show ? (isTableView ? "" : "block") : "none";
                });
            }

            filters.forEach(filterEl => {
                filterEl.addEventListener("click", function () {
                    const selected = this.getAttribute("data-filter");

                    if (selected === IN_TRANSIT_KEY) {
                        if (activeFilter !== EN_ROUTE_KEY) {
                            if (activeFilter !== null) {
                                document.querySelector(`[data-filter="${activeFilter}"]`)?.classList.remove("active");
                            }
                            activeFilter = EN_ROUTE_KEY;
                            document.querySelector(`[data-filter="${EN_ROUTE_KEY}"]`)?.classList.add("active");
                        }

                        // Cycle through states: null → true → false → null
                        if (inTransitState === null) {
                            inTransitState = true; // Show in-transit only
                            this.classList.add("active");
                            this.querySelector(".filter_text").innerText = "In Transit";
                        } else if (inTransitState === true) {
                            inTransitState = false; // Show not-in-transit only
                            this.classList.add("active");
                            this.querySelector(".filter_text").innerText = "Not In Transit";
                        } else {
                            inTransitState = null; // Clear in-transit filter
                            this.classList.remove("active");
                            this.querySelector(".filter_text").innerText = "In Transit";
                        }

                        applyFilter();
                        return;
                    }

                    // Handle other filters
                    if (activeFilter === selected) {
                        this.classList.remove("active");
                        activeFilter = null;
                        inTransitState = null;
                        document.querySelector(`[data-filter="${IN_TRANSIT_KEY}"]`)?.classList.remove("active");
                        document.querySelector(`[data-filter="${IN_TRANSIT_KEY}"] .filter_text`).innerText = "In Transit";
                    } else {
                        if (activeFilter !== null) {
                            document.querySelector(`[data-filter="${activeFilter}"]`)?.classList.remove("active");
                        }
                        this.classList.add("active");
                        activeFilter = selected;

                        if (activeFilter !== EN_ROUTE_KEY) {
                            inTransitState = null;
                            document.querySelector(`[data-filter="${IN_TRANSIT_KEY}"]`)?.classList.remove("active");
                            document.querySelector(`[data-filter="${IN_TRANSIT_KEY}"] .filter_text`).innerText = "In Transit";
                        }
                    }

                    applyFilter();
                });
            });

            applyFilter();
        });



    </script>


    <script>

        function updateUserImage() {
            const username = document.getElementById("username").innerHTML;
            const firstLetter = username.charAt(0).toUpperCase();
            const img = document.querySelector(".user_img img");
            const userInitial = document.querySelector(".user_initial");

            if (img.src === "" || img.src.endsWith("/")) {
                img.style.display = "none";
                userInitial.textContent = firstLetter;
                userInitial.style.display = "flex";
            } else {
                img.style.display = "block";
                userInitial.style.display = "none";

            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            updateUserImage();
        });

        function handleFileUpload(event) {
            const file = event.target.files[0]; // Get the selected file
            if (file) {
                alert(`File uploaded: ${file.name}`);
                // You can process the file here (e.g., send to server, display preview, etc.)
            }
        }


        // const waybillContainer = document.querySelector(".waybill_container")
        const waybill = document.getElementById('waybill');
        const zoomContainer = document.getElementById('zoom-container');

        // Initialize Panzoom
        const panzoom = Panzoom(waybill, {
            maxScale: 2,
            minScale: 0.5,
            contain: 'outside'
        });

        window.addEventListener('DOMLAODED', () => {
            // Get the dimensions of the container and the waybill
            const containerWidth = zoomContainer.clientWidth;
            const containerHeight = zoomContainer.clientHeight;
            const waybillWidth = waybill.clientWidth;
            const waybillHeight = waybill.clientHeight;

            // Calculate the best scale to fit the waybill fully inside the container
            const scaleX = containerWidth / waybillWidth;
            const scaleY = containerHeight / waybillHeight;
            const initialScale = Math.min(scaleX, scaleY); // Ensures full visibility without overflow

            // Apply the calculated scale
            panzoom.zoom(initialScale, { animate: true });

            // Optionally, center the waybill
            // panzoom.pan(0, 0, { animate: true });
        });

        // Enable zoom with the mouse wheel
        zoomContainer.addEventListener('wheel', panzoom.zoomWithWheel);






    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"
        integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@panzoom/panzoom/dist/panzoom.min.js"></script>

    <script>
        // document.addEventListener("DOMContentLoaded", function () {
        //     const filters = document.querySelectorAll(".list.filter"); // All filters
        //     const epodBoxes = document.querySelectorAll(".epod_dash_box"); // All boxes
        //     let activeFilter = null; // Track active filter

        //     filters.forEach(filter => {
        //         filter.addEventListener("click", function () {
        //             const selectedFilter = this.getAttribute("data-filter"); // Get filter type

        //             // If clicking the same active filter, reset and show all boxes
        //             if (activeFilter === selectedFilter) {
        //                 filters.forEach(f => f.classList.remove("active")); // Remove active class
        //                 epodBoxes.forEach(box => box.style.display = "block"); // Show all boxes
        //                 activeFilter = null; // Reset active filter
        //                 return;
        //             }

        //             // Otherwise, apply filter
        //             filters.forEach(f => f.classList.remove("active")); // Remove active class
        //             this.classList.add("active"); // Add active class to clicked filter
        //             activeFilter = selectedFilter; // Update active filter

        //             epodBoxes.forEach(box => {
        //                 const statusText = box.querySelector(".status p").innerText.trim(); // Get box status

        //                 let match = false;
        //                 switch (selectedFilter) {
        //                     case "Pending":
        //                         match = statusText === "Awaiting takeoff";
        //                         break;
        //                     case "Completed":
        //                         match = statusText === "In transit";
        //                         break;
        //                     case "Cancelled":
        //                         match = statusText === "Arrived";
        //                         break;
        //                     case "In Progress":
        //                         match = statusText === "Completed";
        //                         break;
        //                 }

        //                 box.style.display = match ? "block" : "none"; //
        //                 box.style.maxWidth = match ? "fit-content" : "auto"; //
        //                 //  Show/hide based on match
        //             });
        //         });
        //     });
        // });
    </script>




    <script>


        // const handleSign = () => {
        //     const signModal = document.querySelector('.sign_modal');
        //     signModal.classList.add('showactb');

        //     // Close modal when clicking outside the sign wrapper
        //     signModal.addEventListener('click', function (event) {
        //         if (!event.target.closest('.sign_wrapper')) {
        //             signModal.classList.remove('showactb');
        //         }
        //     });
        // }

        // const handleSignSubmition = () => {
        //     const signModal = document.querySelector('.sign_modal');
        //     const signWrapper = document.querySelector('.sign_wrapper');
        //     const submitButton = signWrapper.querySelector('button[type="submit"]');
        //     const signMsg = document.querySelector('.sign_msg')

        //     signWrapper.addEventListener('submit', (event) => {
        //         event.preventDefault();
        //         submitButton.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Signing...';
        //         signMsg.innerHTML = 'Document signed successfully!';
        //         setTimeout(() => {
        //             signMsg.innerHTML = '';
        //             signModal.classList.remove('showactb');
        //             submitButton.innerHTML = 'Yes';
        //         }, 2000); // Simulate a delay for signing process
        //     });
        // }


        // const handleStamp = () => {
        //     const StampModal = document.querySelector('.stamp_modal');
        //     StampModal.classList.add('showactb');

        //     // Close modal when clicking outside the Stamp wrapper
        //     StampModal.addEventListener('click', function (event) {
        //         if (!event.target.closest('.stamp_wrapper')) {
        //             StampModal.classList.remove('showactb');
        //         }
        //     });
        // }

        document.addEventListener("DOMContentLoaded", function () {
            let selectedStampArea = null; // Track the clicked area for signing/stamping
            const stampedAreas = new Map();
            // Select all stamp areas
            const stampAreas = document.querySelectorAll(".stamp_p");
            const signButton = document.querySelector(".bt1op");
            const stampButton = document.querySelector(".bt2op");

            // Initially disable buttons
            signButton.disabled = true;
            stampButton.disabled = true;

            const removeActiveStyles = () => {
                stampAreas.forEach(area => area.classList.remove("active-sign-stamp"));
            };


            // Activate buttons when a stamp area is clicked
            stampAreas.forEach(area => {
                area.addEventListener("click", function () {
                    if (area.classList.contains("invalidstamp")) return false
                    removeActiveStyles();
                    selectedStampArea = area; // Store the clicked area
                    area.classList.add("active-sign-stamp");
                    signButton.disabled = false;
                    stampButton.disabled = false;
                });
            });

            const handleAction = (type) => {
                if (selectedStampArea) {
                    const sign = selectedStampArea.querySelector(".sign1");
                    const stamp = selectedStampArea.querySelector(".stamp1");

                    if (type === "signed") sign.classList.add("done");
                    if (type === "stamped") stamp.classList.add("done");

                    if (sign.classList.contains("done") || stamp.classList.contains("done")) {
                        signButton.disabled = true;
                        stampButton.disabled = true;
                    }



                    // Check if both are done
                    if (sign.classList.contains("done") && stamp.classList.contains("done")) {
                        selectedStampArea.classList.add("invalidstamp");
                        signButton.disabled = true;
                        stampButton.disabled = true;
                    }
                }
            };

            stampButton.addEventListener("click", () => handleAction("stamped"));
            signButton.addEventListener("click", () => handleAction("signed"));




            // Handle opening Stamp Modal
            stampButton.addEventListener("click", function () {
                if (selectedStampArea) {
                    document.querySelector(".stamp_modal").classList.add("showactb");
                }
            });

            // Handle opening Sign Modal
            signButton.addEventListener("click", function () {
                if (selectedStampArea) {
                    document.querySelector(".sign_modal").classList.add("showactb");
                }
            });

            // Close Modals when clicking outside
            document.querySelectorAll(".no").forEach(button => {
                button.addEventListener("click", function () {
                    document.querySelector(".stamp_modal").classList.remove("showactb");
                    document.querySelector(".sign_modal").classList.remove("showactb");
                });
            });

            // Handle Signing (No Page Refresh)
            document.querySelector(".sign_wrapper").addEventListener("submit", function (event) {
                event.preventDefault();
                if (!selectedStampArea) return;

                const signElement = selectedStampArea.querySelector(".sign1");
                signElement.innerHTML = "Administrator"; // Use actual signer name
                signElement.style.fontFamily = "'Pacifico', cursive";
                signElement.style.color = "blue";
                signElement.style.fontSize = "14px";

                // Show success message
                document.querySelector(".sign_msg").textContent = "Document signed successfully!";
                document.querySelector(".sign_msg").style.color = "green";

                // Hide modal after signing
                setTimeout(() => {
                    document.querySelector(".sign_modal").classList.remove("showactb");
                    document.querySelector(".sign_msg").textContent = "";
                }, 1500);
            });

            // Handle Stamping (No Page Refresh)
            document.querySelector("#stampForm").addEventListener("submit", function (e) {
                e.preventDefault();
                if (!selectedStampArea) return;

                // Load JSON Data
                fetch("stamp.json")
                    .then(response => response.json())
                    .then(data => {
                        let recordId = document.querySelector("input[name='record_id']").value;
                        let userId = document.querySelector("input[name='user_id']").value;
                        let record = data.find(item => item.record_id === recordId && item.user_id === userId);

                        if (record) {
                            record.status = "stamped"; // Update status

                            console.log("Updated record:", record);

                            // Add stamp to the selected area
                            const stampElement = selectedStampArea.querySelector(".stamp1");
                            const svgContent = `<svg xmlns="http://www.w3.org/2000/svg" width="300" height="300" viewBox="0 0 300 300">
  <defs>
    <style>
      :root {
        --csl-color: #003399;
        --csl-line-color: #003399;
        --csl-text-color: #000000;
      }
      .outer-circle {
        fill: none;
        stroke: var(--csl-color);
        stroke-width: 2;
      }
      .inner-circle {
        fill: none;
        stroke: var(--csl-color);
        stroke-width: 2;
      }
      .inner-circle1 {
        fill: none;
        stroke: var(--csl-color);
        stroke-width: 1;
      }
      .text-main {
        font-family: Arial, sans-serif;
        font-size: 40px;
        font-weight: bold;
        fill: var(--csl-text-color);
        text-anchor: middle;
      }
      .text-secondary {
        font-family: Arial, sans-serif;
        font-size: 13px;
        fill: var(--csl-text-color);
        text-anchor: middle;
        text-transform: uppercase;
      }
      .dotted-line {
        fill: none;
        stroke: var(--csl-color);
        stroke-width: 2;
        stroke-dasharray: 5 5;
      }
      .stampdate {
        text-anchor: middle;
        font-size: 20px;
        font-weight: bold;
        fill: var(--csl-text-color);
      }
      .lines {
        stroke: var(--csl-line-color);
        stroke-width: 1;
      }
      .dot {
        fill: transparent;
        stroke: var(--csl-color);
      }
    </style>
    <path id="topTextPath" d="M 45,128 A 123,91 0 0,1 255,128" />
    <path id="bottomTextPath" d="M 45,182 A 113,70 0 0,0 255,182" />
  </defs>
  <g>
    <!-- Outer circle -->
    <ellipse cx="150" cy="150" rx="140" ry="100" class="outer-circle" />
    <!-- Inner circles -->
    <ellipse cx="150" cy="150" rx="125" ry="85" class="inner-circle" />
    <ellipse cx="150" cy="150" rx="138" ry="98" class="inner-circle1" />
    <!-- Center text -->
    <text x="150" y="145" class="text-main">PAID</text>
    <!-- Curved upper text -->
    <text class="text-secondary">
      <textPath href="#topTextPath" startOffset="50%">CODESPRO STAMP</textPath>
    </text>
    <!-- Curved lower text -->
    <text class="text-secondary">
      <textPath href="#bottomTextPath" startOffset="50%">CODESPRO STAMP</textPath>
    </text>
    <!-- Horizontal lines -->
    <line class="lines" x1="60" y1="150" x2="240" y2="150" />
    <line class="lines" x1="80" y1="180" x2="220" y2="180" />
    <!-- Date -->
    <text class="stampdate" x="150" y="170" id="dateText">18-04-2024</text>
    <!-- Dots inside the inner circle -->
    <circle cx="40" cy="150" r="4" class="dot csl_stamp_color" />
    <circle cx="40" cy="150" r="2.5" class="dot csl_stamp_color" />
    <circle cx="41" cy="140" r="3.5" class="dot csl_stamp_color" />
    <circle cx="41" cy="160" r="3.5" class="dot csl_stamp_color" />
    


    <circle cx="260" cy="150" r="4" class="dot csl_stamp_color" />
   
    <circle cx="260" cy="150" r="2.5" class="dot csl_stamp_color" />
    <circle cx="259" cy="139" r="3.5" class="dot csl_stamp_color" />

    <circle cx="260" cy="160" r="3.5" class="dot csl_stamp_color" />
 
  </g>
</svg>
`;
                            stampElement.innerHTML = svgContent;

                            const updateStampDate = () => {
                                const dateText = selectedStampArea.querySelector(".stamp1 .stampdate");
                                const now = new Date();

                                if (dateText) {
                                    const dateString = now.toLocaleDateString("en-GB").replace(/\//g, "-");
                                    const hours = now.getHours().toString().padStart(2, '0');
                                    const minutes = now.getMinutes().toString().padStart(2, '0');
                                    dateText.textContent = `${dateString} ${hours}:${minutes}`;
                                }
                            };
                            updateStampDate();


                            selectedStampArea.classList.add("no-border");
                            // Show success message
                            document.querySelector(".stamp_msg").textContent = "Document stamped successfully!";
                            document.querySelector(".stamp_msg").style.color = "green";

                            // Hide modal after stamping
                            setTimeout(() => {
                                document.querySelector(".stamp_modal").classList.remove("showactb");
                                document.querySelector(".stamp_msg").textContent = "";
                            }, 1500);

                        } else {
                            document.querySelector(".stamp_msg").textContent = "Record not found.";
                            document.querySelector(".stamp_msg").style.color = "red";
                        }
                    })
                    .catch(() => {
                        document.querySelector(".stamp_msg").textContent = "Error loading data.";
                        document.querySelector(".stamp_msg").style.color = "red";
                    });
            });
        });





        document.querySelectorAll(".sign1, .stamp1").forEach(element => {
            element.addEventListener("mouseenter", function () {
                let deleteBtn = document.createElement("button");
                deleteBtn.innerHTML = `<i class='fa fa-trash'></i>`;
                deleteBtn.classList.add("delete-btn");
                deleteBtn.onclick = function () {
                    element.classList.remove("done");
                    element.parentElement.classList.remove("invalidstamp");
                    signButton.disabled = false;
                    stampButton.disabled = false;
                    deleteBtn.remove();
                };
                element.appendChild(deleteBtn);
            });

            element.addEventListener("mouseleave", function () {
                let deleteBtn = element.querySelector(".delete-btn");
                if (deleteBtn) deleteBtn.remove();
            });
        });





        const handleStampSubmition = () => {
            const StampModal = document.querySelector('.stamp_modal');
            const StampWrapper = document.querySelector('.stamp_wrapper');
            const submitButton = StampWrapper.querySelector('button[type="submit"]');
            const StampMsg = document.querySelector('.stamp_msg')

            StampWrapper.addEventListener('submit', (event) => {
                event.preventDefault();
                submitButton.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Stamping...';
                StampMsg.innerHTML = 'Document Stamped successfully!';
                setTimeout(() => {
                    StampMsg.innerHTML = '';
                    StampModal.classList.remove('showactb');
                    submitButton.innerHTML = 'Yes';
                }, 2000); // Simulate a delay for Stamping process
            });
        }


        const handleCloseModal = () => {
            const StampModal = document.querySelector('.stamp_modal');
            const signModal = document.querySelector('.sign_modal');

            StampModal.classList.remove('showactb')
            signModal.classList.remove('showactb')
        }




        document.addEventListener("DOMContentLoaded", function () {
            const tabs = document.querySelectorAll(".epod_navlinks button");
            const contents = document.querySelectorAll(".epod-tab_contents .tab");

            // Set initial active tab
            document.querySelector(".epod_navlinks .current").classList.add("active");
            document.querySelector(".epod-tab_contents .tab").classList.add("active");

            tabs.forEach(tab => {
                tab.addEventListener("click", function () {
                    // Remove 'current' class from all tabs
                    tabs.forEach(t => t.classList.remove("current"));

                    // Hide all content divs
                    contents.forEach(content => content.classList.remove("active"));

                    // Add 'current' class to the clicked tab
                    this.classList.add("current");

                    // Show corresponding content
                    const tabId = this.id;
                    document.querySelector(`.epod-tab_contents #${tabId}`).classList.add("active");
                });
            });
        });

        // 12233444
        const handleSideToggle = () => {
            const epodDetails = document.querySelector('.epod_cont main .epod_details');


            document.querySelector('.epod_cont main .epod_details').classList.toggle('show')

            epodDashBoxs.forEach((b) => b.classList.remove('active'));

        }

        const epodDashBoxs = document.querySelectorAll('.epod_dash_box');
        const epodDetails = document.querySelector('.epod_cont main .epod_details');
        const loadingAnimation = document.querySelector('.loading-animation');

        // Remove 'active' class from all initially
        epodDashBoxs.forEach((b) => b.classList.remove('active'));

        epodDashBoxs.forEach((box) => {
            box.addEventListener('click', () => {
                // Remove 'active' from all boxes
                epodDashBoxs.forEach((b) => b.classList.remove('active'));

                // Add 'active' only to the clicked box
                box.classList.add('active');

                // Show epod_details
                epodDetails.classList.add('show');
                loadingAnimation.classList.add('show');

                setTimeout(() => {
                    loadingAnimation.classList.remove('show');
                }, 3000);
            });
        });


        document.querySelector(".chat_btn").addEventListener("click", function () {
            document.querySelector(".chat_action").classList.toggle("active");
        });

        // Close dropdown if clicked outside
        document.addEventListener("click", function (event) {
            if (!document.querySelector(".chat_action").contains(event.target)) {
                document.querySelector(".chat_action").classList.remove("active");
            }
        });



        document.querySelector(".call_btn").addEventListener("click", function () {
            // alert('me')
            document.querySelector(".call_action").classList.toggle("active");
        });

        // Close dropdown if clicked outside
        document.addEventListener("click", function (event) {
            if (!document.querySelector(".call_action").contains(event.target)) {
                document.querySelector(".call_action").classList.remove("active");
            }
        });

        // document.querySelectorAll(".filter").forEach(filter => {
        //     filter.addEventListener("click", function () {
        //         this.classList.toggle("active");
        //     });
        // });

        const handleDropSearch = () => {
            document.querySelector('.epod_cont main .epod_tracking .search_box').classList.toggle('show')
        }

        function previewDocument(fileName) {
            let fileExtension = fileName.split('.').pop().toLowerCase();
            let pdfPreview = document.getElementById("pdf_preview");
            let imagePreview = document.getElementById("image_preview");
            let unsupportedPreview = document.getElementById("unsupported_preview");

            pdfPreview.style.display = "none";
            imagePreview.style.display = "none";
            unsupportedPreview.style.display = "none";

            if (fileExtension === "pdf") {
                pdfPreview.src = fileName;
                pdfPreview.style.display = "block";
            } else if (["jpg", "jpeg", "png", "gif"].includes(fileExtension)) {
                imagePreview.src = fileName;
                imagePreview.style.display = "block";
            } else {
                unsupportedPreview.style.display = "block";
            }
        }

        let currentImageElement = null;

        function openPreview(imgElement, title) {
            if (imgElement.src) {
                currentImageElement = imgElement;
                document.getElementById("previewImage").src = imgElement.src;
                document.getElementById("modalTitle").textContent = title; // Set modal title
                document.getElementById("fileName").textContent = ""; // Reset file name
                document.getElementById("imageModal").style.display = "block";
            }
        }

        function previewImage() {
            const fileInput = document.getElementById("imageInput");
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                const reader = new FileReader();

                reader.onload = function (e) {
                    document.getElementById("previewImage").src = e.target.result;
                    document.getElementById("fileName").textContent = file.name; // Show file name
                };

                reader.readAsDataURL(file);
            }
        }

        function saveImage() {
            if (currentImageElement) {
                currentImageElement.src = document.getElementById("previewImage").src;
            }
            closeModal();
        }

        function closeModal() {
            document.getElementById("imageModal").style.display = "none";
        }



        function rateDriver(stars) {
            let starElements = document.querySelectorAll('.rating.driver_r .star i'); // Select the <i> inside .star

            starElements.forEach((icon, index) => {
                if (index < stars) {
                    icon.classList.add('active');
                    icon.classList.replace('fa-light', 'fa-solid'); // Change to filled star
                } else {
                    icon.classList.remove('active');
                    icon.classList.replace('fa-solid', 'fa-light'); // Reset to outlined star
                }
            });
        }



        function rateVehicle(stars) {
            let starElements = document.querySelectorAll('.rating.vehicle_v .star i');
            starElements.forEach((icon, index) => {
                if (index < stars) {
                    icon.classList.add('active');
                    icon.classList.replace('fa-light', 'fa-solid'); // Change to filled star
                } else {
                    icon.classList.remove('active');
                    icon.classList.replace('fa-solid', 'fa-light'); // Reset to outlined star
                }
            });
        }

        function submitDriverFeedback() {
            let comment = document.getElementById('comment').value;
            let rating = document.querySelectorAll('.star i.active').length;
            if (rating === 0) {
                alert('Please select a rating.');
                return;
            }
            alert(`Feedback Submitted!\nRating: ${rating} stars\nComment: ${comment}`);
        }

        function submitVehicleFeedback() {
            let comment = document.getElementById('comment').value;
            let rating = document.querySelectorAll('.star i.active').length;
            if (rating === 0) {
                alert('Please select a rating.');
                return;
            }
            alert(`Feedback Submitted!\nRating: ${rating} stars\nComment: ${comment}`);
        }

        // ---error-----------
        document.addEventListener("DOMContentLoaded", () => {
            const shipmentMap = document.querySelector("#shipment .map");
            const shipmentCancel = document.querySelector(".map_header .cancel_button");
            shipmentMap.classList.remove('shipment-d')
            if (!shipmentMap || !shipmentCancel) return; // Exit if elements are missing

            // Add class on map click
            shipmentMap.addEventListener("click", () => shipmentMap.classList.add("shipment-d"));

            // Remove class on cancel button click
            shipmentCancel.addEventListener("click", () => {
                console.log("Before removal:", shipmentMap.classList);

                setTimeout(() => {
                    shipmentMap.classList.remove("shipment-d");
                    console.log("After removal:", shipmentMap.classList);
                }, 10); // Delay slightly
            });

        });

        // const collapse_w = document.querySelector('.collapse_action');
        // const collapseIcon = document.querySelector('.collapse_action i');
        // const actionOp = document.querySelector('.actions_op');

        // collapse.addEventListener('click', () => {
        //     actionOp.classList.toggle('noshowp')
        //     collapseIcon.classList.toggle('rotate_p')
        // })



        function updateScale(value) {
            document.querySelector('.waybill_container').style.transform = `scale(${value})`;
        }

        function scaleToFitScreen() {
            const waybill = document.querySelector('.waybill_container');
            const containerWidth = waybill.offsetWidth;
            const containerHeight = waybill.offsetHeight;
            const screenWidth = window.innerWidth;
            const screenHeight = window.innerHeight;

            // Calculate scale factors
            const scaleWidth = screenWidth / containerWidth;
            const scaleHeight = screenHeight / containerHeight;

            // Use the smallest scale to fit both width and height
            const bestScale = Math.min(scaleWidth, scaleHeight);

            // Apply scaling
            waybill.style.transform = `scale(${bestScale})`;
            waybill.style.transformOrigin = "top center"; // Ensures scaling happens from the top-left corner
        }

        document.addEventListener("DOMContentLoaded", () => {
            scaleToFitScreen();
        })





    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip-utils/0.1.0/jszip-utils.min.js"
        integrity="sha512-3WaCYjK/lQuL0dVIRt1thLXr84Z/4Yppka6u40yEJT1QulYm9pCxguF6r8V84ndP5K03koI9hV1+zo/bUbgMtA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"
        integrity="sha512-XMVd28F1oH/O71fzwBnV7HucLxVwtxf26XV8P4wPk26EDxuGZ91N8bsOttmnomcCD3CS5ZMRL50H0GgOHvegtg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"
        integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/share-this/1.3.1/sharers/email.min.js"
        integrity="sha512-4+h27jVJhdlqWwk0hvKQX2Ow5TYcyRWaYwj5hhDem63JbmslVJHqJu29zQN/ZRM/Dbg4qi9nbbx6wRwmf/S2Yw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/share-this/1.3.1/sharers/facebook.min.js"
        integrity="sha512-Wh1ZDYa/KLkn2iK8a0D4FoZSqXbw1bRFCPjVs490MpcMFs1zHtMQMpqBVAqheGpRFLcGEMy/jnFmFx+6rbGJzw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/share-this/1.3.1/sharers/linked-in.min.js"
        integrity="sha512-nTV0Ogc/rLbqPZXBz+2ivICqVU7ZGjMjJCzP2S/Tdgolqb2eVc+PBLQ9D+l9WpxJz7POEeRxSOMWXdmGrSbIlQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/share-this/1.3.1/sharers/twitter.min.js"
        integrity="sha512-p0d6Rkeb1XLqCBlKVz7aF+UQNu4tGmAxT5NjJPYasGU8KmXvL8iEd8j/cvuJbqYK3HnVJqmf4ulWZvLx+2a4Fw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        function downloadImg() {
            const waybill = document.querySelector('.doc_img');

            html2canvas(waybill, { scale: 2 }).then(canvas => {
                const imgData = canvas.toDataURL("image/png");
                const link = document.createElement("a");
                link.href = imgData;
                link.download = "image.png";
                link.click();
            });
        }

        async function shareWaydocFile() {
            const selectedFileInput = document.querySelector('.doc_checkbox:checked');

            if (!selectedFileInput) {
                alert("No document selected for sharing.");
                return;
            }

            let filePath = selectedFileInput.getAttribute("data-file");

            try {
                // Fetch the file as a blob
                let response = await fetch(filePath);
                let blob = await response.blob();
                let fileName = filePath.split('/').pop(); // Extract file name from URL
                let file = new File([blob], fileName, { type: blob.type });

                // Check if Web Share API supports file sharing
                if (navigator.canShare && navigator.canShare({ files: [file] })) {
                    await navigator.share({
                        title: "Shared Waybill Document",
                        text: `Sharing document: ${fileName}`,
                        files: [file]
                    });
                } else {
                    alert("Sharing not supported on this device.");
                }
            } catch (error) {
                console.error("Error sharing file:", error);
                alert("Failed to share the document.");
            }
        }


        function downloadSelectedDocs() {
            let selectedFiles = document.querySelectorAll(".doc_checkbox:checked");
            selectedFiles.forEach((checkbox) => {
                let fileName = checkbox.getAttribute("data-file");
                let link = document.createElement("a");
                link.href = fileName;
                link.download = fileName;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            });
        }

        // function downloadDocAsPDF() {
        //     const { jsPDF } = window.jspdf;
        //     const waybill = document.querySelector('.doc_img');

        //     html2canvas(waybill, { scale: 2 }).then(canvas => {
        //         const imgData = canvas.toDataURL("image/png");
        //         const pdf = new jsPDF('p', 'mm', 'a4');
        //         const imgWidth = 210;
        //         const imgHeight = (canvas.height * imgWidth) / canvas.width;

        //         pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
        //         pdf.save("image.pdf");
        //     });
        // }

        async function downloadDocAsZIP() {
            let zip = new JSZip();
            let selectedFiles = document.querySelectorAll(".doc_checkbox:checked");

            if (selectedFiles.length === 0) {
                alert("No documents selected for download.");
                return;
            }

            let promises = [];
            selectedFiles.forEach(checkbox => {
                let fileName = checkbox.getAttribute("data-file");
                let filePath = fileName; // Update this if files are in a different folder

                // Fetch each file and add it to the ZIP
                let filePromise = fetch(filePath)
                    .then(response => response.blob())
                    .then(blob => {
                        zip.file(fileName, blob);
                    });

                promises.push(filePromise);
            });

            // Wait for all files to be added before generating the ZIP
            Promise.all(promises).then(() => {
                zip.generateAsync({ type: "blob" }).then(content => {
                    saveAs(content, "documents.zip");
                });
            });
        }



        function downloadImage() {
            const waybill = document.querySelector('#previewImage');


            html2canvas(waybill, { scale: 2 }).then(canvas => {
                const imgData = canvas.toDataURL("image/png");
                const link = document.createElement("a");
                link.href = imgData;
                link.download = "name.png";
                link.click();
            });

            // const imgSrc = document.getElementById("imageModal").dataset.imageSrc; // Get stored image src
            // const fileName = document.getElementById("fileName").innerText;

            // const link = document.createElement("a");
            // link.href = imgSrc;
            // link.download = fileName;
            // document.body.appendChild(link);
            // link.click();
            // document.body.removeChild(link);
        }

        // 

        const collapse = document.querySelector('.collapse_action');
        const collapseIcon = document.querySelector('.collapse_action i');
        const actionOp = document.querySelector('.actions_op');

        collapse.addEventListener('click', () => {
            actionOp.classList.toggle('noshowp')
            collapseIcon.classList.toggle('rotate_p')
        })



        async function shareImage() {
            const waybill = document.querySelector('#previewImage');

            html2canvas(waybill, { scale: 2 }).then(async (canvas) => {
                const imgData = canvas.toDataURL("image/png");

                // Convert base64 to a Blob
                const blob = await fetch(imgData).then(res => res.blob());
                const file = new File([blob], "name.png", { type: "image/png" });

                // Check if Web Share API is available
                if (navigator.canShare && navigator.canShare({ files: [file] })) {
                    try {
                        await navigator.share({
                            title: "Waybill Document",
                            text: "Here is the waybill document.",
                            files: [file]
                        });
                    } catch (error) {
                        console.error("Error sharing:", error);
                    }
                } else {
                    alert("Sharing not supported on this device.");
                }
            });
        }







    </script>
    <script>
        // Function to convert all SVGs inside the document to PNG

        // Function to capture and download the waybill as an image
        const downloadWaybillAsImage = () => {
            const waybill = document.querySelector(".waybill_container");

            if (!waybill) {
                console.error("Waybill container not found!");
                return;
            }

            // Store the current transform state of the waybill
            const originalTransform = waybill.style.transform;

            // Temporarily reset the transform to its original, unscaled state
            // This ensures html2canvas captures the full-size element
            waybill.style.transform = 'none';

            html2canvas(waybill, { scale: 2 }).then(canvas => {
                // Restore the original transform after the screenshot is taken
                waybill.style.transform = originalTransform;

                const imgData = canvas.toDataURL("image/png");
                const link = document.createElement("a");
                link.href = imgData;
                link.download = "waybill.png";
                link.click();
            });
        };


        async function shareWaybillAsImage() {
            const waybill = document.querySelector('.waybill_container');

            html2canvas(waybill, { scale: 2 }).then(async (canvas) => {
                const imgData = canvas.toDataURL("image/png");

                // Convert base64 to a Blob
                const blob = await fetch(imgData).then(res => res.blob());
                const file = new File([blob], "waybill.png", { type: "image/png" });

                // Check if Web Share API is available
                if (navigator.canShare && navigator.canShare({ files: [file] })) {
                    try {
                        await navigator.share({
                            title: "Waybill Document",
                            text: "Here is the waybill document.",
                            files: [file]
                        });
                    } catch (error) {
                        console.error("Error sharing:", error);
                    }
                } else {
                    alert("Sharing not supported on this device.");
                }
            });
        }


        function copyToClipboard(text) {
            const tempInput = document.createElement('textarea');
            tempInput.value = text;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);
            alert('Link copied to clipboard. Please paste it into your social media post.');
        }

        function downloadWaybillAsPDF() {
            const { jsPDF } = window.jspdf;
            const waybill = document.querySelector('.waybill_container');

            // Store the current transform state of the waybill
            const originalTransform = waybill.style.transform;

            // Temporarily reset the transform to the original scale (no zoom)
            // This ensures html2canvas captures the full, unscaled element
            waybill.style.transform = 'none';
            waybill.style.transform = 'scale(1)';

            html2canvas(waybill, { scale: 2 }).then(canvas => {
                // Restore the original transform after the screenshot is taken
                waybill.style.transform = originalTransform;

                const imgData = canvas.toDataURL("image/png");
                const pdf = new jsPDF('p', 'mm', 'a4');
                const imgWidth = 210;
                const imgHeight = 297;

                pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
                pdf.save("waybill.pdf");
            });
        }


        document.querySelector('.collapse_button').addEventListener('click', function () {
            const mapContainer = document.querySelector('.map_t');
            const collapseButton = this;

            if (mapContainer.classList.contains('collapsed')) {
                mapContainer.classList.remove('collapsed');
                collapseButton.textContent = 'Collapse map';
            } else {
                mapContainer.classList.add('collapsed');
                collapseButton.textContent = 'Expand map';
            }
        });






    </script>
    <script>
        const userSignature = "Ayomide";

        // Buttons
        const startTripBtn = document.getElementById('startTrip');
        const arrivalBtn = document.getElementById('markArrival');
        const confirmBtn = document.getElementById('confirmArrival');
        const offloadBtn = document.getElementById('offloadCompleted');

        // Status areas
        const tripStatus = document.querySelector('#tripStatus .status_value');
        const arrivalStatus = document.querySelector('#arrivalStatus .status_value');
        const confirmStatus = document.querySelector('#confirmarrivalStatus .status_value');
        const offloadStatus = document.querySelector('#offcompletionStatus .status_value');

        const getCurrentTime = () => new Date().toLocaleString();

        const showLoading = (button, statusElement) => {
            button.classList.add('loading');
            button.innerHTML = `Processing <span class="spinner"></span>`;
            statusElement.innerHTML = `<span class="spinner"></span> Updating...`;
        };

        const showSuccess = (button, statusElement, message, originalText) => {
            button.classList.remove('loading');
            button.innerHTML = originalText;
            statusElement.innerHTML = `${message} <span class="checkmark">✔</span>`;
        };

        const updateStatus = (button, statusElement, label, originalText) => {
            if (statusElement.textContent.includes("Not yet")) {
                showLoading(button, statusElement);

                setTimeout(() => {
                    const recordTime = getCurrentTime();
                    showSuccess(button, statusElement, `${label} at ${recordTime} by ${userSignature}`, originalText);
                }, 1500);
            } else {
                alert(`${label} has already been recorded!`);
            }
        };

        // Event listeners
        startTripBtn.addEventListener('click', () => {
            updateStatus(startTripBtn, tripStatus, "Trip started", "Start Trip");
        });

        arrivalBtn.addEventListener('click', () => {
            if (!tripStatus.textContent.includes("Not yet")) {
                updateStatus(arrivalBtn, arrivalStatus, "Arrived", "Mark as Arrived");
            } else {
                alert("Start the trip before marking arrival.");
            }
        });

        confirmBtn.addEventListener('click', () => {
            if (!arrivalStatus.textContent.includes("Not yet")) {
                updateStatus(confirmBtn, confirmStatus, "Arrival Confirmed", "Confirm Arrival");
            } else {
                alert("You need to mark arrival first before confirming.");
            }
        });

        offloadBtn.addEventListener('click', () => {
            if (!confirmStatus.textContent.includes("Not yet")) {
                updateStatus(offloadBtn, offloadStatus, "Offload Completed", "Offload Completed");
            } else {
                alert("You need to confirm arrival before marking offload completion.");
            }
        });
    </script>




    <script src="./script.js"></script>
</body>

</html>